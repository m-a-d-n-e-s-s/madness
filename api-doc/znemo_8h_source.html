<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MADNESS: znemo.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MADNESS<span id="projectnumber">&#160;0.10.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6b18f4c94988b4c3175a7db89843d784.html">madness</a></li><li class="navelem"><a class="el" href="dir_b532689c3323d91448a1a1607e0a94cf.html">chem</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">znemo.h</div></div>
</div><!--header-->
<div class="contents">
<a href="znemo_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Nemocomplex.h</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> *  Created on: 14 Nov 2018</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> *      Author: fbischoff</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> */</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#ifndef SRC_APPS_CHEM_ZNEMO_H_</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#define SRC_APPS_CHEM_ZNEMO_H_</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;<a class="code" href="CalculationParameters_8h.html">madness/chem/CalculationParameters.h</a>&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;<a class="code" href="MolecularOrbitals_8h.html">madness/chem/MolecularOrbitals.h</a>&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="QCCalculationParametersBase_8h.html">madness/mra/QCCalculationParametersBase.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;<a class="code" href="SCFOperators_8h.html">madness/chem/SCFOperators.h</a>&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;<a class="code" href="molecular__optimizer_8h.html">madness/chem/molecular_optimizer.h</a>&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="madness_2chem_2molecularbasis_8h.html">madness/chem/molecularbasis.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="molecule_8h.html">madness/chem/molecule.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="nemo_8h.html">madness/chem/nemo.h</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="info_8h.html">madness/misc/info.h</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="mra_8h.html">madness/mra/mra.h</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="nonlinsol_8h.html">madness/mra/nonlinsol.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="operator_8h.html">madness/mra/operator.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="vmra_8h.html">madness/mra/vmra.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacemadness.html">madness</a> {</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">class </span>Diamagnetic_potential_factor;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="foldopen" id="foldopen00031" data-start="{" data-end="};">
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html">   31</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structmadness_1_1printleveler.html">printleveler</a> {</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a8afd355e11ea95c2977f1e18cb505718">   32</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a8afd355e11ea95c2977f1e18cb505718">print_nothing_</a>=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#af8bc31d2647f543b97b37c34c0d68534">   33</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#af8bc31d2647f543b97b37c34c0d68534">print_setup_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a64fe54adb15f6df53c93d2f95f27e077">   34</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a64fe54adb15f6df53c93d2f95f27e077">print_energies_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a33efe02a8e4dfe3ca0d06d0b598c78fc">   35</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a33efe02a8e4dfe3ca0d06d0b598c78fc">print_timings_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a4c9dff6a6fd34ad5f31fda2d14750118">   36</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a4c9dff6a6fd34ad5f31fda2d14750118">print_convergence_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#adb014d08baa8b3b19a1e2e5e88acd265">   37</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#adb014d08baa8b3b19a1e2e5e88acd265">print_debug_information_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="foldopen" id="foldopen00039" data-start="{" data-end="}">
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#aa8d87cdf65980bbcb56ca429f2e033b0">   39</a></span>    <a class="code hl_function" href="structmadness_1_1printleveler.html#aa8d87cdf65980bbcb56ca429f2e033b0">printleveler</a>(<span class="keywordtype">int</span> printlevel) {</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>        <a class="code hl_variable" href="structmadness_1_1printleveler.html#adb014d08baa8b3b19a1e2e5e88acd265">print_debug_information_</a>=(printlevel&gt;=10);</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>        <a class="code hl_variable" href="structmadness_1_1printleveler.html#a4c9dff6a6fd34ad5f31fda2d14750118">print_convergence_</a>=(printlevel&gt;=4);</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        <a class="code hl_variable" href="structmadness_1_1printleveler.html#a33efe02a8e4dfe3ca0d06d0b598c78fc">print_timings_</a>=(printlevel&gt;=3);</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>        <a class="code hl_variable" href="structmadness_1_1printleveler.html#a64fe54adb15f6df53c93d2f95f27e077">print_energies_</a>=(printlevel&gt;=2);</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>        <a class="code hl_variable" href="structmadness_1_1printleveler.html#af8bc31d2647f543b97b37c34c0d68534">print_setup_</a>=(printlevel&gt;=1);</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    }</div>
</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a4e7efe029a814d3bd4afb54a5d424d96">   47</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structmadness_1_1printleveler.html#a4e7efe029a814d3bd4afb54a5d424d96">print_setup</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#af8bc31d2647f543b97b37c34c0d68534">print_setup_</a>;}</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a79847d286914f8461de38de37a917230">   48</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structmadness_1_1printleveler.html#a79847d286914f8461de38de37a917230">print_energies</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a64fe54adb15f6df53c93d2f95f27e077">print_energies_</a>;}</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#af5bb77f4c86d949d55a0ea6276817bab">   49</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structmadness_1_1printleveler.html#af5bb77f4c86d949d55a0ea6276817bab">print_timings</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a33efe02a8e4dfe3ca0d06d0b598c78fc">print_timings_</a>;}</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a6685bd8378fe43d170b2ea225a4196f8">   50</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structmadness_1_1printleveler.html#a6685bd8378fe43d170b2ea225a4196f8">print_convergence</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#a4c9dff6a6fd34ad5f31fda2d14750118">print_convergence_</a>;}</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="structmadness_1_1printleveler.html#a828bd771f863023985660935c103c3fa">   51</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="structmadness_1_1printleveler.html#a828bd771f863023985660935c103c3fa">print_debug</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="structmadness_1_1printleveler.html#adb014d08baa8b3b19a1e2e5e88acd265">print_debug_information_</a>;}</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>};</div>
</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="foldopen" id="foldopen00056" data-start="{" data-end="};">
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html">   56</a></span><span class="keyword">class </span><a class="code hl_class" href="classmadness_1_1Nemo__complex__Parameters.html">Nemo_complex_Parameters</a> : <span class="keyword">public</span> <a class="code hl_class" href="classmadness_1_1QCCalculationParametersBase.html">QCCalculationParametersBase</a> {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="comment"></span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">    /// ctor reading out the input file</span></div>
<div class="foldopen" id="foldopen00060" data-start="{" data-end="}">
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a08b762233b3a5bfa6f006be16a1c4311">   60</a></span><span class="comment"></span>    <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a08b762233b3a5bfa6f006be16a1c4311">Nemo_complex_Parameters</a>() {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        initialize&lt;double&gt;(<span class="stringliteral">&quot;physical_B&quot;</span>,0.0);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        initialize&lt;double&gt;(<span class="stringliteral">&quot;explicit_B&quot;</span>,0.0);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>        initialize&lt;std::vector&lt;double&gt; &gt;(<span class="stringliteral">&quot;box&quot;</span>,{1.0, 0.01, 0.0, 0.0, 0.0});</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        initialize&lt;double&gt;(<span class="stringliteral">&quot;shift&quot;</span>,0.0);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        initialize&lt;int&gt;(<span class="stringliteral">&quot;printlevel&quot;</span>,2);        <span class="comment">// 0: energies, 1: fock matrix, 2: function sizes</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        initialize&lt;bool&gt;(<span class="stringliteral">&quot;use_v_vector&quot;</span>,<span class="keyword">false</span>);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        initialize&lt;double&gt;(<span class="stringliteral">&quot;potential_radius&quot;</span>,-1.0);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>        initialize&lt;std::vector&lt;std::string&gt; &gt;(<span class="stringliteral">&quot;guess&quot;</span>,std::vector&lt;std::string&gt;(),<span class="stringliteral">&quot;list of l,m,exponent&quot;</span>);   <span class="comment">// atomic guess functions l, ml, exponent</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        initialize&lt;std::vector&lt;std::string&gt; &gt;(<span class="stringliteral">&quot;guess_functions&quot;</span>,std::vector&lt;std::string&gt;(),<span class="stringliteral">&quot;list function names&quot;</span>);  <span class="comment">// atomic guess functions l, ml, exponent</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    }</div>
</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="foldopen" id="foldopen00072" data-start="{" data-end="}">
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a83c09a3f30876b911bce5d818cc9b699">   72</a></span>    <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a83c09a3f30876b911bce5d818cc9b699">Nemo_complex_Parameters</a>(<a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; world, <span class="keyword">const</span> <a class="code hl_struct" href="structmadness_1_1commandlineparser.html">commandlineparser</a>&amp; parser) : <a class="code hl_class" href="classmadness_1_1Nemo__complex__Parameters.html">Nemo_complex_Parameters</a>() {</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <span class="comment">// read input file</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <a class="code hl_function" href="classmadness_1_1QCCalculationParametersBase.html#a0cff12488c973bc263aecfb2b3fdac26">read_input_and_commandline_options</a>(world,parser,<span class="stringliteral">&quot;complex&quot;</span>);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    }</div>
</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="foldopen" id="foldopen00077" data-start="{" data-end="}">
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a0787b664514eaaa8898f3d99aeb5fa1a">   77</a></span>    std::string <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a0787b664514eaaa8898f3d99aeb5fa1a">get_tag</a>()<span class="keyword"> const override </span>{</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;complex&quot;</span>);</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    }</div>
</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="foldopen" id="foldopen00081" data-start="{" data-end="}">
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#aef4216f09d0a1a8cc0112734c293dd19">   81</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#aef4216f09d0a1a8cc0112734c293dd19">set_derived_values</a>() {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        <span class="keywordtype">double</span> pb=<a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ab3c3d651162a9f929f9e20cb341e7b64">physical_B</a>();</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        <span class="keywordtype">double</span> eb=<a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#abeb9ee67835ee08dc430ba7576fb3bb2">explicit_B</a>();</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="keywordtype">double</span> remaining_B=fabs(pb-eb);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="rk_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>=<a class="code hl_function" href="classmadness_1_1FunctionDefaults.html#a3fc8a34a12e6078b1cc9fd2a57bcf4d2">FunctionDefaults&lt;3&gt;::get_thresh</a>()*0.1;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <span class="keywordtype">double</span> wave_function_radius=2.0*sqrt(-log(<a class="code hl_variable" href="rk_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>)/remaining_B);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ad3b27c7466fe7f96ec0154fddc625923">potential_radius</a>=wave_function_radius*1.6;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        <span class="keywordtype">double</span> box_radius=wave_function_radius*1.33;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <a class="code hl_function" href="classmadness_1_1QCCalculationParametersBase.html#af53065bc29d6ef85e77cf1af000233d5">set_derived_value</a>(<span class="stringliteral">&quot;box&quot;</span>,std::vector&lt;double&gt;{box_radius,0.01});</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        <a class="code hl_function" href="classmadness_1_1QCCalculationParametersBase.html#af53065bc29d6ef85e77cf1af000233d5">set_derived_value</a>(<span class="stringliteral">&quot;potential_radius&quot;</span>,<a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ad3b27c7466fe7f96ec0154fddc625923">potential_radius</a>);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <a class="code hl_function" href="classmadness_1_1QCCalculationParametersBase.html#af53065bc29d6ef85e77cf1af000233d5">set_derived_value</a>(<span class="stringliteral">&quot;shift&quot;</span>,<a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ab3c3d651162a9f929f9e20cb341e7b64">physical_B</a>());</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    }</div>
</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a2d91b942aa3a78ac7000d50b2de1ee01">   97</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a2d91b942aa3a78ac7000d50b2de1ee01">printlevel</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;int&gt;(<span class="stringliteral">&quot;printlevel&quot;</span>);}</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a76b4d557cb2b564fe8d7cb073d7a6641">   98</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a76b4d557cb2b564fe8d7cb073d7a6641">shift</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;double&gt;(<span class="stringliteral">&quot;shift&quot;</span>);}</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#ab3c3d651162a9f929f9e20cb341e7b64">   99</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ab3c3d651162a9f929f9e20cb341e7b64">physical_B</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;double&gt;(<span class="stringliteral">&quot;physical_b&quot;</span>);}</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#abeb9ee67835ee08dc430ba7576fb3bb2">  100</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#abeb9ee67835ee08dc430ba7576fb3bb2">explicit_B</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;double&gt;(<span class="stringliteral">&quot;explicit_b&quot;</span>);}</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a5ce5da00ff1538800c750b53e84a0c20">  101</a></span>    std::vector&lt;double&gt; <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a5ce5da00ff1538800c750b53e84a0c20">box</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;std::vector&lt;double&gt; &gt;(<span class="stringliteral">&quot;box&quot;</span>);}</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#ad3b27c7466fe7f96ec0154fddc625923">  102</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ad3b27c7466fe7f96ec0154fddc625923">potential_radius</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;double&gt;(<span class="stringliteral">&quot;potential_radius&quot;</span>);}</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a89247ac2588f48b4ffe83baaac5074e0">  103</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a89247ac2588f48b4ffe83baaac5074e0">use_v_vector</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;bool&gt;(<span class="stringliteral">&quot;use_v_vector&quot;</span>);}</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a04d8b52b0eb76bdc205d51d7f1354a12">  104</a></span>    std::vector&lt;std::string&gt; <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a04d8b52b0eb76bdc205d51d7f1354a12">guess</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;std::vector&lt;std::string&gt;&gt;(<span class="stringliteral">&quot;guess&quot;</span>);}</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="classmadness_1_1Nemo__complex__Parameters.html#a4de09727f73bc13c75bae044137dd473">  105</a></span>    std::vector&lt;std::string&gt; <a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#a4de09727f73bc13c75bae044137dd473">guess_functions</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> get&lt;std::vector&lt;std::string&gt;&gt;(<span class="stringliteral">&quot;guess_functions&quot;</span>);}</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>};</div>
</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="foldopen" id="foldopen00110" data-start="{" data-end="};">
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html">  110</a></span><span class="keyword">class </span><a class="code hl_class" href="classmadness_1_1Znemo.html">Znemo</a> : <span class="keyword">public</span> <a class="code hl_class" href="classmadness_1_1NemoBase.html">NemoBase</a>, <span class="keyword">public</span> <a class="code hl_class" href="classmadness_1_1QCPropertyInterface.html">QCPropertyInterface</a> {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a49c3289f11be3d9fc6acbf364f961166">  111</a></span>    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code hl_class" href="classmadness_1_1Zcis.html">Zcis</a>;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="foldopen" id="foldopen00113" data-start="{" data-end="};">
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html">  113</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structmadness_1_1Znemo_1_1potentials.html">potentials</a> {</div>
<div class="foldopen" id="foldopen00114" data-start="{" data-end="}">
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#a0dfea63b113ad7f8de94f06c189f3dd9">  114</a></span>        <a class="code hl_function" href="structmadness_1_1Znemo_1_1potentials.html#a0dfea63b113ad7f8de94f06c189f3dd9">potentials</a>(<a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; <a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <span class="keyword">const</span> std::size_t nmo) {</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">vnuc_mo</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a2bb76a6eef11d54d60bd6f6ee4264d87">diamagnetic_mo</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a159928fc9acc182736f02623518be6f0">lz_mo</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#adc4282b48753d168c72d5afd826325a8">J_mo</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aff940e4fd605b40ca1e6df6566e624a6">K_mo</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aa0d26284e07afd3375019b07e41d59b5">spin_zeeman_mo</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a891a859813d48fd07e30a91871ffb275">zeeman_R_comm</a>=zero_functions&lt;double_complex,3&gt;(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,nmo);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        }</div>
</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="foldopen" id="foldopen00125" data-start="{" data-end="}">
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#a5ba10496fef897ab77c9b3040b1dde8a">  125</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="structmadness_1_1Znemo_1_1potentials.html#a5ba10496fef897ab77c9b3040b1dde8a">transform</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double_complex&gt;</a>&amp; U) {</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>            <a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; <a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>=<a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">vnuc_mo</a>[0].world();</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">vnuc_mo</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">vnuc_mo</a>, U);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a2bb76a6eef11d54d60bd6f6ee4264d87">diamagnetic_mo</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a2bb76a6eef11d54d60bd6f6ee4264d87">diamagnetic_mo</a>, U);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a159928fc9acc182736f02623518be6f0">lz_mo</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a159928fc9acc182736f02623518be6f0">lz_mo</a>, U);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#adc4282b48753d168c72d5afd826325a8">J_mo</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#adc4282b48753d168c72d5afd826325a8">J_mo</a>, U);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aff940e4fd605b40ca1e6df6566e624a6">K_mo</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aff940e4fd605b40ca1e6df6566e624a6">K_mo</a>, U);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aa0d26284e07afd3375019b07e41d59b5">spin_zeeman_mo</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aa0d26284e07afd3375019b07e41d59b5">spin_zeeman_mo</a>, U);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a891a859813d48fd07e30a91871ffb275">zeeman_R_comm</a> = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">::madness::transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a891a859813d48fd07e30a91871ffb275">zeeman_R_comm</a>, U);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        }</div>
</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">  137</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">vnuc_mo</a>;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#a2bb76a6eef11d54d60bd6f6ee4264d87">  138</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a2bb76a6eef11d54d60bd6f6ee4264d87">diamagnetic_mo</a>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#a159928fc9acc182736f02623518be6f0">  139</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a159928fc9acc182736f02623518be6f0">lz_mo</a>;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#adc4282b48753d168c72d5afd826325a8">  140</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#adc4282b48753d168c72d5afd826325a8">J_mo</a>;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#aff940e4fd605b40ca1e6df6566e624a6">  141</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aff940e4fd605b40ca1e6df6566e624a6">K_mo</a>;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#aa0d26284e07afd3375019b07e41d59b5">  142</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#aa0d26284e07afd3375019b07e41d59b5">spin_zeeman_mo</a>;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#a4d71daabe33626fe903f9d592b2ec48b">  143</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a4d71daabe33626fe903f9d592b2ec48b">lz_commutator</a>;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1potentials.html#a891a859813d48fd07e30a91871ffb275">  144</a></span>        std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1potentials.html#a891a859813d48fd07e30a91871ffb275">zeeman_R_comm</a>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    };</div>
</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="keyword">public</span>:</div>
<div class="foldopen" id="foldopen00147" data-start="{" data-end="};">
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html">  147</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structmadness_1_1Znemo_1_1timer.html">timer</a> {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">  148</a></span>        <a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">  149</a></span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#ab3ca5b3f99d1dc69f5a71a4f18f91904">ttt</a>,<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">sss</a>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">  150</a></span>        <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">do_print</a>=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="foldopen" id="foldopen00152" data-start="{" data-end="}">
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html#a9a440782d56c05ab04bc2c45db9c05a4">  152</a></span>        <a class="code hl_function" href="structmadness_1_1Znemo_1_1timer.html#a9a440782d56c05ab04bc2c45db9c05a4">timer</a>(<a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>, <span class="keywordtype">bool</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">do_print</a>=<span class="keyword">true</span>) : <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>), <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">do_print</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">do_print</a>) {</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>.<a class="code hl_variable" href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">gop</a>.<a class="code hl_function" href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">fence</a>();</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#ab3ca5b3f99d1dc69f5a71a4f18f91904">ttt</a>=<a class="code hl_function" href="namespacemadness.html#aa9b46b378a475000e5fc99f204a778dd">wall_time</a>();</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">sss</a>=<a class="code hl_function" href="namespacemadness.html#a1ae5928a1d5da5680156d9e198da3fa0">cpu_time</a>();</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        }</div>
</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="foldopen" id="foldopen00158" data-start="{" data-end="}">
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html#a06f6d9a8bdfa9131af9bd6f3cc2c78f5">  158</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="structmadness_1_1Znemo_1_1timer.html#a06f6d9a8bdfa9131af9bd6f3cc2c78f5">tag</a>(<span class="keyword">const</span> std::string msg) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>.<a class="code hl_variable" href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">gop</a>.<a class="code hl_function" href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">fence</a>();</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            <span class="keywordtype">double</span> <a class="code hl_variable" href="lapack_8cc.html#a60612d39c03186dc3f7a12b859718c6f">tt1</a>=<a class="code hl_function" href="namespacemadness.html#aa9b46b378a475000e5fc99f204a778dd">wall_time</a>()-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#ab3ca5b3f99d1dc69f5a71a4f18f91904">ttt</a>;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            <span class="keywordtype">double</span> <a class="code hl_variable" href="lapack_8cc.html#a3579439861af6b9e1cb7409d286ad0f6">ss1</a>=<a class="code hl_function" href="namespacemadness.html#a1ae5928a1d5da5680156d9e198da3fa0">cpu_time</a>()-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">sss</a>;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>.<a class="code hl_function" href="classmadness_1_1World.html#a6cb4bff7804dc04970620fa61acd7876">rank</a>()==0 and <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">do_print</a>) printf(<span class="stringliteral">&quot;timer: %20.20s %8.2fs %8.2fs\n&quot;</span>, msg.c_str(), <a class="code hl_variable" href="lapack_8cc.html#a3579439861af6b9e1cb7409d286ad0f6">ss1</a>, <a class="code hl_variable" href="lapack_8cc.html#a60612d39c03186dc3f7a12b859718c6f">tt1</a>);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#ab3ca5b3f99d1dc69f5a71a4f18f91904">ttt</a>=<a class="code hl_function" href="namespacemadness.html#aa9b46b378a475000e5fc99f204a778dd">wall_time</a>();</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">sss</a>=<a class="code hl_function" href="namespacemadness.html#a1ae5928a1d5da5680156d9e198da3fa0">cpu_time</a>();</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        }</div>
</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="foldopen" id="foldopen00167" data-start="{" data-end="}">
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1timer.html#a4b26baf0f375694c26ecbba4bbfbaa71">  167</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="structmadness_1_1Znemo_1_1timer.html#a4b26baf0f375694c26ecbba4bbfbaa71">end</a>(<span class="keyword">const</span> std::string msg) {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>.<a class="code hl_variable" href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">gop</a>.<a class="code hl_function" href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">fence</a>();</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>            <span class="keywordtype">double</span> <a class="code hl_variable" href="lapack_8cc.html#a60612d39c03186dc3f7a12b859718c6f">tt1</a>=<a class="code hl_function" href="namespacemadness.html#aa9b46b378a475000e5fc99f204a778dd">wall_time</a>()-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#ab3ca5b3f99d1dc69f5a71a4f18f91904">ttt</a>;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>            <span class="keywordtype">double</span> <a class="code hl_variable" href="lapack_8cc.html#a3579439861af6b9e1cb7409d286ad0f6">ss1</a>=<a class="code hl_function" href="namespacemadness.html#a1ae5928a1d5da5680156d9e198da3fa0">cpu_time</a>()-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">sss</a>;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">world</a>.<a class="code hl_function" href="classmadness_1_1World.html#a6cb4bff7804dc04970620fa61acd7876">rank</a>()==0 and <a class="code hl_variable" href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">do_print</a>) printf(<span class="stringliteral">&quot;timer: %20.20s %8.2fs %8.2fs\n&quot;</span>, msg.c_str(), <a class="code hl_variable" href="lapack_8cc.html#a3579439861af6b9e1cb7409d286ad0f6">ss1</a>, <a class="code hl_variable" href="lapack_8cc.html#a60612d39c03186dc3f7a12b859718c6f">tt1</a>);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        }</div>
</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    };</div>
</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <a class="code hl_class" href="classmadness_1_1Znemo.html">Znemo</a>(<a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; <a class="code hl_function" href="DKops_8h.html#a2508e63045d8be6e94a968aa8aec0a32">w</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structmadness_1_1commandlineparser.html">commandlineparser</a>&amp; parser);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="comment"></span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="comment">    /// compute the molecular energy</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a8110755fc79a66af89f492c318319b22">  180</a></span><span class="comment"></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a8110755fc79a66af89f492c318319b22">value</a>() {<span class="keywordflow">return</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a8110755fc79a66af89f492c318319b22">value</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">mol</a>.<a class="code hl_function" href="classmadness_1_1Molecule.html#a4ba7e8c61bc08da5db2041e64ba7be3d">get_all_coords</a>());}</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span><span class="comment"></span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="comment">    /// compute the molecular energy</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="comment"></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a8110755fc79a66af89f492c318319b22">value</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a>&amp; x) <span class="keyword">override</span>;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a5002eb04c90955caa0bed9fa0da15c4d">output_calc_info_schema</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code hl_variable" href="derivatives_8cc.html#a423df6189110b25bb1b2836671974b25">energy</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a5bf8107836bb648ddc0f02d94f197f11">  187</a></span>    std::string <a class="code hl_function" href="classmadness_1_1Znemo.html#a5bf8107836bb648ddc0f02d94f197f11">name</a>()<span class="keyword"> const override </span>{<span class="keywordflow">return</span> <span class="stringliteral">&quot;znemo&quot;</span>;};</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="foldopen" id="foldopen00189" data-start="{" data-end="}">
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#ae22a44d7521d15baa736bd735ffc21d7">  189</a></span>    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#ae22a44d7521d15baa736bd735ffc21d7">help</a>() {</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        <a class="code hl_function" href="namespacemadness.html#a19b289c4e20e33679e6ecbdbd9ae22af">print_header2</a>(<span class="stringliteral">&quot;help page for ZNEMO &quot;</span>);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;The znemo code computes Hartree-Fock energies and gradients in the presence of a strong&quot;</span>);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;magnetic field&quot;</span>);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;You can print all available calculation parameters by running\n&quot;</span>);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;znemo --print_parameters\n&quot;</span>);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;You can perform a simple calculation by running\n&quot;</span>);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;znemo --geometry=h2o.xyz\n&quot;</span>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;provided you have an xyz file in your directory.&quot;</span>);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    }</div>
</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="foldopen" id="foldopen00202" data-start="{" data-end="}">
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#ac36abfca4832188baaaf4d21bab982f3">  202</a></span>    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#ac36abfca4832188baaaf4d21bab982f3">print_parameters</a>() {</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <a class="code hl_class" href="classmadness_1_1Nemo__complex__Parameters.html">Nemo_complex_Parameters</a> zparam;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        <a class="code hl_struct" href="structmadness_1_1Nemo_1_1NemoCalculationParameters.html">Nemo::NemoCalculationParameters</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#aee1b16196826d19e0c579ba4b856b972">param</a>;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;default calculations parameters for the znemo program are the same as for the nemo program&quot;</span>);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;default parameters for the magnetic field of the znemo program are&quot;</span>);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        zparam.<a class="code hl_function" href="classmadness_1_1QCCalculationParametersBase.html#a84045c85e4fa94fdd992f87713572b4d">print</a>(<span class="stringliteral">&quot;complex&quot;</span>,<span class="stringliteral">&quot;end&quot;</span>);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;\n\nthe molecular geometry must be specified in a separate block:&quot;</span>);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <a class="code hl_function" href="classmadness_1_1Molecule.html#ab02e99ae776d968ff248ff2f51e28532">Molecule::print_parameters</a>();</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    }</div>
</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="foldopen" id="foldopen00212" data-start="{" data-end="}">
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#ae174cfb20531f395ac5ded0343cd74b5">  212</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#ae174cfb20531f395ac5ded0343cd74b5">selftest</a>()<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    };</div>
</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span><span class="comment"></span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="comment">    /// adapt the thresholds consistently to a common value</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#ab90ee118f5422f1bf3b0601fd3059790">recompute_factors_and_potentials</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="rk_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a4f6565b72915d58a225cf517d80cfc94">need_recompute_factors_and_potentials</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="rk_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) <span class="keyword">const override</span>;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#ad13b6868a1147feee75520be06c1b693">invalidate_factors_and_potentials</a>() <span class="keyword">override</span>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a605e9f6fc76c0d9ee87bb67c3b5d022f">iterate</a>();</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#aaebe821b6d46469c791b9cee0a0c170a">gradient</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a>&amp; x) <span class="keyword">override</span>;</div>
<div class="foldopen" id="foldopen00225" data-start="{" data-end="}">
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#aaebe821b6d46469c791b9cee0a0c170a">  225</a></span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#aaebe821b6d46469c791b9cee0a0c170a">gradient</a>() {</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#aaebe821b6d46469c791b9cee0a0c170a">gradient</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">mol</a>.<a class="code hl_function" href="classmadness_1_1Molecule.html#a4ba7e8c61bc08da5db2041e64ba7be3d">get_all_coords</a>());</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    }</div>
</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#aeb6ae33e799ce690bec15d8d436d2960">test</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">  231</a></span>    <span class="keyword">const</span> <a class="code hl_struct" href="structmadness_1_1CalculationParameters.html">CalculationParameters</a>&amp; <a class="code hl_function" href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">get_calc_param</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classmadness_1_1Znemo.html#ae8459d714cfeb7737939113810452850">calc_param</a>;};</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a0dcc8df1b11dfa1016ba0805e030f922">  232</a></span>    <a class="code hl_class" href="classmadness_1_1Molecule.html">Molecule</a>&amp; <a class="code hl_function" href="classmadness_1_1Znemo.html#a0dcc8df1b11dfa1016ba0805e030f922">molecule</a>()<span class="keyword"> override </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">mol</a>;};</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#af34dd775886b5397cf770b3a94bd1e7b">  233</a></span>    <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Molecule.html">Molecule</a>&amp; <a class="code hl_function" href="classmadness_1_1Znemo.html#af34dd775886b5397cf770b3a94bd1e7b">molecule</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">mol</a>;};</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="comment"></span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="comment">    /// test the identity &lt;F| f (T + Vdia ) f |F&gt; = &lt;F|f^2 (T + Udia) |F&gt;</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a35700bb81dbfed953cba0a124d5cbb5d">test_U_potentials</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="comment"></span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="comment">    /// analyse the results only</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span><span class="comment">    /// @return the energy</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="comment"></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#addac25f4106e5d3df7836d1494545f03">analyze</a>();</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="comment"></span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="comment">    /// compute the expectation value of the kinetic momentum p</span></div>
<div class="foldopen" id="foldopen00244" data-start="{" data-end="}">
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a71070a9df0c9ac6ac85d6ffd36fcffd0">  244</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#a71070a9df0c9ac6ac85d6ffd36fcffd0">compute_kinetic_momentum</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> p_exp(3);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mo : <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>) p_exp+=<a class="code hl_function" href="namespacemadness.html#ab993d652410fcc0ae07582302d281ceb">imag</a>(<a class="code hl_function" href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">inner</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,mo,<a class="code hl_function" href="namespacemadness.html#ad54b4e42440e93ddb426ed9f2e7a8c0e">grad</a>(mo)));</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mo : <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>) p_exp+=<a class="code hl_function" href="namespacemadness.html#ab993d652410fcc0ae07582302d281ceb">imag</a>(<a class="code hl_function" href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">inner</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,mo,<a class="code hl_function" href="namespacemadness.html#ad54b4e42440e93ddb426ed9f2e7a8c0e">grad</a>(mo)));</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="keywordflow">return</span> p_exp;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    }</div>
</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="comment"></span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment">    /// compute the expectation value of the linear moment r</span></div>
<div class="foldopen" id="foldopen00252" data-start="{" data-end="}">
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#ac11e7b5c56da3d10a0d24279fe872f88">  252</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#ac11e7b5c56da3d10a0d24279fe872f88">compute_linear_moment</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        std::vector&lt;real_function_3d&gt; r(3);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        r[0]=<a class="code hl_typedef" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>).functor([] (<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; r) {<span class="keywordflow">return</span> r[0];});</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        r[1]=<a class="code hl_typedef" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>).functor([] (<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; r) {<span class="keywordflow">return</span> r[1];});</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        r[2]=<a class="code hl_typedef" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>).functor([] (<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; r) {<span class="keywordflow">return</span> r[2];});</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> r_exp(3);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mo : <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>) r_exp+=<a class="code hl_function" href="namespacemadness.html#ae040c842d4ec0217aafc3183463851ae">real</a>(<a class="code hl_function" href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">inner</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,mo,r*mo));</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mo : <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>) r_exp+=<a class="code hl_function" href="namespacemadness.html#ae040c842d4ec0217aafc3183463851ae">real</a>(<a class="code hl_function" href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">inner</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,mo,r*mo));</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <span class="keywordflow">return</span> r_exp;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    }</div>
</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="comment"></span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="comment">    /// compute the expectation value of the magnetic vector potential A</span></div>
<div class="foldopen" id="foldopen00265" data-start="{" data-end="}">
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a76cc6c3696b6da16acb9bdbd3b3844d2">  265</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#a76cc6c3696b6da16acb9bdbd3b3844d2">compute_magnetic_potential_expectation</a>(<span class="keyword">const</span> std::vector&lt;real_function_3d&gt;&amp; <a class="code hl_class" href="classA.html">A</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> A_exp(3);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mo : <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>) A_exp+=<a class="code hl_function" href="namespacemadness.html#ae040c842d4ec0217aafc3183463851ae">real</a>(<a class="code hl_function" href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">inner</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,mo,<a class="code hl_class" href="classA.html">A</a>*mo));</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; mo : <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>) A_exp+=<a class="code hl_function" href="namespacemadness.html#ae040c842d4ec0217aafc3183463851ae">real</a>(<a class="code hl_function" href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">inner</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,mo,<a class="code hl_class" href="classA.html">A</a>*mo));</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <span class="keywordflow">return</span> A_exp;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    }</div>
</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="comment"></span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="comment">    /// compute the shift of the molecule such that the kinetic momentum vanishes</span></div>
<div class="foldopen" id="foldopen00273" data-start="{" data-end="}">
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a406d9ab2851b633105609c937c0f42d0">  273</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#a406d9ab2851b633105609c937c0f42d0">compute_standard_gauge_shift</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a>&amp; p_exp)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> S(3);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_class" href="classB.html">B</a>=<a class="code hl_variable" href="classmadness_1_1Znemo.html#aee1b16196826d19e0c579ba4b856b972">param</a>.<a class="code hl_function" href="classmadness_1_1Nemo__complex__Parameters.html#ab3c3d651162a9f929f9e20cb341e7b64">physical_B</a>();</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        S(0l)=-p_exp(1);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        S(1) =p_exp(0l);</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        S(2) =p_exp(2);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        S*=-2.0/(<a class="code hl_class" href="classB.html">B</a>*(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>.size()+<a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>.size()));</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <span class="keywordflow">return</span> S;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    }</div>
</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment"></span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="comment">    /// compute the current density</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment"></span>    std::vector&lt;real_function_3d&gt; <a class="code hl_function" href="classmadness_1_1Znemo.html#af4f6efa6ad411cd427598854eea2600a">compute_current_density</a>(</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; alpha_mo,</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; beta_mo) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="comment"></span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment">    /// compute the magnetic vector potential A</span></div>
<div class="foldopen" id="foldopen00290" data-start="{" data-end="}">
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#abe4acb8ff8437f8eacb64bcd19d7128b">  290</a></span><span class="comment"></span>    <span class="keyword">static</span> std::vector&lt;real_function_3d&gt; <a class="code hl_function" href="classmadness_1_1Znemo.html#abe4acb8ff8437f8eacb64bcd19d7128b">compute_magnetic_vector_potential</a>(<a class="code hl_class" href="classmadness_1_1World.html">World</a>&amp; <a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>,</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; Bvec) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        std::vector&lt;real_function_3d&gt; r(3), <a class="code hl_class" href="classA.html">A</a>(3);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        r[0]=<a class="code hl_typedef" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>).functor([] (<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; r) {<span class="keywordflow">return</span> r[0];});</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        r[1]=<a class="code hl_typedef" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>).functor([] (<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; r) {<span class="keywordflow">return</span> r[1];});</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        r[2]=<a class="code hl_typedef" href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">real_factory_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>).functor([] (<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; r) {<span class="keywordflow">return</span> r[2];});</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        <a class="code hl_class" href="classA.html">A</a>[0]=Bvec[1]*r[2]-Bvec[2]*r[1];</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        <a class="code hl_class" href="classA.html">A</a>[1]=Bvec[2]*r[0]-Bvec[0l]*r[2];</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <a class="code hl_class" href="classA.html">A</a>[2]=Bvec[0l]*r[1]-Bvec[1]*r[0];</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>        <span class="keywordflow">return</span> 0.5*<a class="code hl_class" href="classA.html">A</a>;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    }</div>
</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="comment"></span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span><span class="comment">    /// are there explicit beta orbitals</span></div>
<div class="foldopen" id="foldopen00305" data-start="{" data-end="}">
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a6be8a7102f97e39a78e4f1d4a1320417">  305</a></span><span class="comment"></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a6be8a7102f97e39a78e4f1d4a1320417">have_beta</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <span class="keywordflow">return</span> ((not <a class="code hl_function" href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">get_calc_param</a>().spin_restricted()) and (<a class="code hl_function" href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">get_calc_param</a>().nbeta()&gt;0));</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    }</div>
</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a894c8462e21ea96561c1bd88d4482d20">save_orbitals</a>(std::string suffix) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="comment"></span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="comment">    /// get initial orbitals from guesses</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a9109d31192a479195217d393f2d1e6c4">get_initial_orbitals</a>();</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="comment"></span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="comment">    /// read the guess orbitals from a previous nemo or moldft calculation</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment"></span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#a2f2d6ad046923b0735260bb54a269514">read_real_guess</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment"></span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="comment">    /// read the guess orbitals from a previous nemo or moldft calculation</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="comment"></span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#ab1f5b0315ed2da5be4700bc474182c6f">read_complex_guess</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="comment"></span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">    /// read a list of functions for the guess</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="comment"></span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#a791a92973074002eca7f706a49127148">read_explicit_guess_functions</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span><span class="comment"></span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="comment">    /// read guess as projection of the orbitals onto an AO basis set (for geometry optimization)</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span><span class="comment"></span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#a34888143e61570a2ef5156f08e5f818c">read_restartaodata</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="comment"></span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="comment">    /// read orbitals from a znemo calculation</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment"></span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#a32b08f72c29469bd85367ef7b48ba822">read_reference</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment"></span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="comment">    /// hcore guess including the magnetic field</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span><span class="comment"></span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#adf7ac1c52deeac1ab5aa80e87fbe17e9">hcore_guess</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    std::pair&lt;MolecularOrbitals&lt;double_complex,3&gt;, <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> &gt;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <a class="code hl_function" href="classmadness_1_1Znemo.html#ac2fc430ef425a3f9afb3216aba8b895f">custom_guess</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="foldopen" id="foldopen00341" data-start="{" data-end="}">
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a894c8462e21ea96561c1bd88d4482d20">  341</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a894c8462e21ea96561c1bd88d4482d20">save_orbitals</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        std::string <a class="code hl_function" href="classmadness_1_1Znemo.html#a5bf8107836bb648ddc0f02d94f197f11">name</a>=<span class="stringliteral">&quot;reference&quot;</span>;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;saving orbitals to file&quot;</span>,<a class="code hl_function" href="classmadness_1_1Znemo.html#a5bf8107836bb648ddc0f02d94f197f11">name</a>);</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>        <a class="code hl_class" href="classmadness_1_1archive_1_1ParallelOutputArchive.html">archive::ParallelOutputArchive&lt;archive::BinaryFstreamOutputArchive&gt;</a> ar(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_function" href="classmadness_1_1Znemo.html#a5bf8107836bb648ddc0f02d94f197f11">name</a>.c_str(), 1);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        ar &amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>.size() &amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>.size() &amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a104720c700bd16ceee7ed803c4da6728">aeps</a> &amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a397b9f2602a2465588edab2fb092ccae">beps</a>;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="nonlinschro_8cc.html#ab725778fe3179d0229a8da4c908bdf61">a</a>: <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>) ar &amp; <a class="code hl_variable" href="nonlinschro_8cc.html#ab725778fe3179d0229a8da4c908bdf61">a</a>;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_variable" href="nonlinschro_8cc.html#ab725778fe3179d0229a8da4c908bdf61">a</a>: <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>) ar &amp; <a class="code hl_variable" href="nonlinschro_8cc.html#ab725778fe3179d0229a8da4c908bdf61">a</a>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        <span class="comment">// save AO restart data</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        <a class="code hl_class" href="classmadness_1_1MolecularOrbitals.html">MolecularOrbitals&lt;double_complex,3&gt;</a> amo1, bmo1;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>        amo1.<a class="code hl_function" href="classmadness_1_1MolecularOrbitals.html#aa4bff2b25ac8ba47ce94b22f722bcb8d">update_mos_and_eps</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>,<a class="code hl_variable" href="classmadness_1_1Znemo.html#a104720c700bd16ceee7ed803c4da6728">aeps</a>);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>        bmo1.<a class="code hl_function" href="classmadness_1_1MolecularOrbitals.html#aa4bff2b25ac8ba47ce94b22f722bcb8d">update_mos_and_eps</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>,<a class="code hl_variable" href="classmadness_1_1Znemo.html#a397b9f2602a2465588edab2fb092ccae">beps</a>);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <a class="code hl_function" href="classmadness_1_1MolecularOrbitals.html#a0ddf92975e3c9266e808cc8013db00bd">MolecularOrbitals&lt;double_complex,3&gt;::save_restartaodata</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">mol</a>, amo1, bmo1, <a class="code hl_variable" href="classmadness_1_1Znemo.html#a07cb2cb9abcdeb6d1f9e603bdf08caad">aobasis</a>);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    }</div>
</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a1b210d8c1169c2d4153e8aebec0a6226">do_step_restriction</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; mo,</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            std::vector&lt;complex_function_3d&gt;&amp; mo_new) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="comment"></span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="comment">    /// rotate the KAIN subspace (cf. SCF.cc)</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="comment"></span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> solverT&gt;</div>
<div class="foldopen" id="foldopen00364" data-start="{" data-end="}">
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a248145bc6215e59b2f0dc5f0acfe79eb">  364</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a248145bc6215e59b2f0dc5f0acfe79eb">rotate_subspace</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double_complex&gt;</a>&amp; U, solverT&amp; solver)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        <span class="keywordtype">double</span> trantol=<a class="code hl_function" href="classmadness_1_1FunctionDefaults.html#a3fc8a34a12e6078b1cc9fd2a57bcf4d2">FunctionDefaults&lt;3&gt;::get_thresh</a>()*0.1;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        std::vector &lt; std::vector&lt;Function&lt;double_complex, 3&gt; &gt; &gt;&amp;ulist = solver.get_ulist();</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        std::vector &lt; std::vector&lt;Function&lt;double_complex, 3&gt; &gt; &gt;&amp;rlist = solver.get_rlist();</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter = 0; iter &lt; ulist.size(); ++iter) {</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>            std::vector&lt;Function&lt;double_complex, 3&gt; &gt;&amp; <a class="code hl_variable" href="hatom__sf__dirac_8cc.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = ulist[iter];</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>            std::vector&lt;Function&lt;double_complex, 3&gt; &gt;&amp; r = rlist[iter];</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            std::vector&lt;Function&lt;double_complex, 3&gt; &gt; vnew = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, <a class="code hl_variable" href="hatom__sf__dirac_8cc.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, U, trantol, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            std::vector&lt;Function&lt;double_complex, 3&gt; &gt; rnew = <a class="code hl_function" href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">transform</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>, r, U, trantol, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            <a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>.<a class="code hl_variable" href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">gop</a>.<a class="code hl_function" href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">fence</a>();</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;<a class="code hl_variable" href="hatom__sf__dirac_8cc.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.size(); i++) {</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                <a class="code hl_variable" href="hatom__sf__dirac_8cc.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>[i] = vnew[i];</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                r[i] = rnew[i];</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>            }</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        <a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>.<a class="code hl_variable" href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">gop</a>.<a class="code hl_function" href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">fence</a>();</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    }</div>
</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a2f63ad97b890ce8d2e1ca697ee1ba1a0">compute_energy</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>, <span class="keyword">const</span> potentials&amp; apot,</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>, <span class="keyword">const</span> potentials&amp; bpot, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_print, <span class="keyword">const</span> <span class="keywordtype">bool</span> no_confinement) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="comment"></span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span><span class="comment">    /// compute the potential operators applied on the orbitals</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="comment"></span>    potentials <a class="code hl_function" href="classmadness_1_1Znemo.html#a21ebbe19a68192675c0d27482134ec75">compute_potentials</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; mo,</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>            <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a>&amp; <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>,</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; rhs) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double_complex&gt;</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#acd38fc459dba7b980bcd6cd9ee71eb68">compute_vmat</a>(</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; mo,</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>            <span class="keyword">const</span> potentials&amp; pot) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    std::vector&lt;complex_function_3d&gt; <a class="code hl_function" href="classmadness_1_1Znemo.html#a2638afd736e2de41b6bfc8c43d2c65e0">compute_residuals</a>(</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; Vpsi,</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_function" href="hatom__energy_8cc.html#a7572433ce934df0e233caee87519ae12">psi</a>,</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>            <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a>&amp; eps,</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> levelshift=0.0) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a9ebf86f211f50efe4290ca8546d35da0">canonicalize</a>(std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>,</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            std::vector&lt;complex_function_3d&gt;&amp; vnemo,</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>            potentials&amp; pot,</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>            <a class="code hl_class" href="classmadness_1_1XNonlinearSolver.html">XNonlinearSolver</a>&lt;std::vector&lt;complex_function_3d&gt; ,<a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a>, <a class="code hl_struct" href="structmadness_1_1vector__function__allocator.html">vector_function_allocator&lt;double_complex,3&gt;</a> &gt;&amp; solver,</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>            <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double_complex&gt;</a> fock, <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double_complex&gt;</a> ovlp) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    std::vector&lt;complex_function_3d&gt; <a class="code hl_function" href="classmadness_1_1Znemo.html#a7d79347aab059bcb2b111d5cfe1788a4">orthonormalize</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; mo) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    std::vector&lt;complex_function_3d&gt; <a class="code hl_function" href="classmadness_1_1Znemo.html#ae84a8162cdf6462a927124221c0a6e80">normalize</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; mo) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="foldopen" id="foldopen00412" data-start="{" data-end="}">
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#aaa79a16a4d6542bed8b503c32426c046">  412</a></span>    <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#aaa79a16a4d6542bed8b503c32426c046">compute_nemo_density</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>,</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>=<a class="code hl_function" href="classmadness_1_1NemoBase.html#a7b60617da931bb25f9e43c5a06ce3b24">NemoBase::compute_density</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classmadness_1_1Znemo.html#a6be8a7102f97e39a78e4f1d4a1320417">have_beta</a>()) <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>+=<a class="code hl_function" href="classmadness_1_1NemoBase.html#a7b60617da931bb25f9e43c5a06ce3b24">NemoBase::compute_density</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">get_calc_param</a>().spin_restricted()) <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>=<a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>.<a class="code hl_function" href="classmadness_1_1Function.html#a1b4d69841a957d0cbd25948f70d81a2d">scale</a>(2.0);</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    }</div>
</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="foldopen" id="foldopen00421" data-start="{" data-end="}">
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a8fcc2b1b630b540929e14a0c03b5f653">  421</a></span>    <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#a8fcc2b1b630b540929e14a0c03b5f653">compute_nemo_spin_density</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>,</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">get_calc_param</a>().spin_restricted()) <span class="keywordflow">return</span> <a class="code hl_typedef" href="namespacemadness.html#aabc223d277e0d9dd79d7c61d200d457f">real_function_3d</a>(<a class="code hl_variable" href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">world</a>);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>=<a class="code hl_function" href="classmadness_1_1NemoBase.html#a7b60617da931bb25f9e43c5a06ce3b24">NemoBase::compute_density</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classmadness_1_1Znemo.html#a6be8a7102f97e39a78e4f1d4a1320417">have_beta</a>()) <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>-=<a class="code hl_function" href="classmadness_1_1NemoBase.html#a7b60617da931bb25f9e43c5a06ce3b24">NemoBase::compute_density</a>(<a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">density</a>;</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    }</div>
</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#a8825603982fc22bde04b7083df2905be">compute_density</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_function" href="classmadness_1_1Znemo.html#ac1c6ae6af9c6182e2d95b2fca96462f7">compute_spin_density</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>,</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>            <span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    std::vector&lt;complex_function_3d&gt; <a class="code hl_function" href="classmadness_1_1Znemo.html#a664375d3ee579cfccbca8b92bbe9191e">make_bra</a>(<span class="keyword">const</span> std::vector&lt;complex_function_3d&gt;&amp; mo) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">  443</a></span>    <a class="code hl_class" href="classmadness_1_1Molecule.html">Molecule</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">mol</a>;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#aee1b16196826d19e0c579ba4b856b972">  444</a></span>    <a class="code hl_class" href="classmadness_1_1Nemo__complex__Parameters.html">Nemo_complex_Parameters</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#aee1b16196826d19e0c579ba4b856b972">param</a>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a07cb2cb9abcdeb6d1f9e603bdf08caad">  445</a></span>    <a class="code hl_class" href="classmadness_1_1AtomicBasisSet.html">AtomicBasisSet</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#a07cb2cb9abcdeb6d1f9e603bdf08caad">aobasis</a>;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a0882b1047ce5bb92fa5712d678f9b1ec">  446</a></span>    <a class="code hl_struct" href="structmadness_1_1printleveler.html">printleveler</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#a0882b1047ce5bb92fa5712d678f9b1ec">print_info</a>=<a class="code hl_struct" href="structmadness_1_1printleveler.html">printleveler</a>(2);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span><span class="comment"></span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="comment">    /// standard calculation parameters</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a8a291aaaae1b80b96e9638d5884ac51e">  449</a></span><span class="comment"></span>    <a class="code hl_struct" href="structmadness_1_1Nemo_1_1NemoCalculationParameters.html">Nemo::NemoCalculationParameters</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#a8a291aaaae1b80b96e9638d5884ac51e">nemo_param</a>;</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#ae8459d714cfeb7737939113810452850">  450</a></span>    <a class="code hl_struct" href="structmadness_1_1CalculationParameters.html">CalculationParameters</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#ae8459d714cfeb7737939113810452850">calc_param</a>;</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a0e095f9500a5f3582a267a457fd84a97">  452</a></span>    std::shared_ptr&lt;Diamagnetic_potential_factor&gt; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a0e095f9500a5f3582a267a457fd84a97">diafac</a>;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment"></span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span><span class="comment">    /// the magnetic field B=rot(A)</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a78bb27dbb916cd35c98af58a8b84e758">  455</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#a78bb27dbb916cd35c98af58a8b84e758">B</a>;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span><span class="comment"></span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span><span class="comment">    /// nuclear potential</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a8d9dd938b8ca219806804261e001832c">  458</a></span><span class="comment"></span>    std::shared_ptr&lt;PotentialManager&gt; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a8d9dd938b8ca219806804261e001832c">potentialmanager</a>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span><span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="comment">    /// the molecular orbitals -- alpha</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">  461</a></span><span class="comment"></span>    std::vector&lt;complex_function_3d&gt; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">amo</a>, <a class="code hl_variable" href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">bmo</a>;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment">    /// the orbital energies</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a104720c700bd16ceee7ed803c4da6728">  464</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Tensor.html">Tensor&lt;double&gt;</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#a104720c700bd16ceee7ed803c4da6728">aeps</a>, <a class="code hl_variable" href="classmadness_1_1Znemo.html#a397b9f2602a2465588edab2fb092ccae">beps</a>;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span><span class="comment"></span> </div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span><span class="comment">    /// the spherical damping box</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a5e54cba39bbb75c7cf50e238a20a874d">  467</a></span><span class="comment"></span>    <a class="code hl_class" href="classmadness_1_1Function.html">real_function_3d</a> <a class="code hl_variable" href="classmadness_1_1Znemo.html#a5e54cba39bbb75c7cf50e238a20a874d">sbox</a>;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="comment"></span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span><span class="comment">    /// the linear moments r={x,y,z}</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#a1ac6e9d61111880b9cfbdbf2c40f82e9">  470</a></span><span class="comment"></span>    std::vector&lt;real_function_3d&gt; <a class="code hl_variable" href="classmadness_1_1Znemo.html#a1ac6e9d61111880b9cfbdbf2c40f82e9">rvec</a>;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno"><a class="line" href="classmadness_1_1Znemo.html#aab2c221c6d2dc61beff303f3f9cc2f2c">  472</a></span>    std::shared_ptr&lt;real_convolution_3d&gt; <a class="code hl_variable" href="classmadness_1_1Znemo.html#aab2c221c6d2dc61beff303f3f9cc2f2c">coulop</a>;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="foldopen" id="foldopen00475" data-start="{" data-end="};">
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1s__orbital.html">  475</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structmadness_1_1Znemo_1_1s__orbital.html">s_orbital</a> : <span class="keyword">public</span> <a class="code hl_class" href="classmadness_1_1FunctionFunctorInterface.html">FunctionFunctorInterface</a>&lt;double_complex,3&gt; {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1s__orbital.html#a9fa9325d06501eb81bc9382527c57083">  477</a></span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a9fa9325d06501eb81bc9382527c57083">exponent</a>=1.0;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1s__orbital.html#a17936530b038777b846169966b1bf5ed">  478</a></span>        <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a17936530b038777b846169966b1bf5ed">origin</a>={0.0,0.0,0.0};</div>
<div class="foldopen" id="foldopen00479" data-start="{" data-end="}">
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1s__orbital.html#a2ae6ee7f468c98032cb62a521ac692ff">  479</a></span>        <a class="code hl_function" href="structmadness_1_1Znemo_1_1s__orbital.html#a2ae6ee7f468c98032cb62a521ac692ff">s_orbital</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; expo, <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; o) :</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            <a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a9fa9325d06501eb81bc9382527c57083">exponent</a>(expo), <a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a17936530b038777b846169966b1bf5ed">origin</a>(o) {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            <a class="code hl_define" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a9fa9325d06501eb81bc9382527c57083">exponent</a>&gt;0.0);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        }</div>
</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="foldopen" id="foldopen00484" data-start="{" data-end="}">
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1s__orbital.html#aadd23c028c9e5616327999ff80e60d57">  484</a></span>        <a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a> <a class="code hl_function" href="structmadness_1_1Znemo_1_1s__orbital.html#aadd23c028c9e5616327999ff80e60d57">operator()</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; xyz1)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>            <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> xyz=xyz1-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a17936530b038777b846169966b1bf5ed">origin</a>;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>            <span class="keywordtype">double</span> r=xyz.<a class="code hl_function" href="classmadness_1_1Vector.html#a5aa070640348cc2f71587b2065f85d31">normf</a>();</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            <span class="keywordflow">return</span> exp(-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1s__orbital.html#a9fa9325d06501eb81bc9382527c57083">exponent</a>*r);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        }</div>
</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    };</div>
</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="foldopen" id="foldopen00492" data-start="{" data-end="};">
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1p__orbital.html">  492</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structmadness_1_1Znemo_1_1p__orbital.html">p_orbital</a> : <span class="keyword">public</span> <a class="code hl_class" href="classmadness_1_1FunctionFunctorInterface.html">FunctionFunctorInterface</a>&lt;double_complex,3&gt; {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span> </div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">  494</a></span>        <span class="keywordtype">long</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">m</a>=0;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">  495</a></span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">exponent</a>=1.0;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1p__orbital.html#ad9131acef5fa236edb8e506de5e7f3ec">  496</a></span>        <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#ad9131acef5fa236edb8e506de5e7f3ec">origin</a>={0.0,0.0,0.0};</div>
<div class="foldopen" id="foldopen00497" data-start="{" data-end="}">
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1p__orbital.html#a624bdac5c7845297e26eab06e07f6e58">  497</a></span>        <a class="code hl_function" href="structmadness_1_1Znemo_1_1p__orbital.html#a624bdac5c7845297e26eab06e07f6e58">p_orbital</a>(<span class="keyword">const</span> <span class="keywordtype">long</span>&amp; mm, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; expo, <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; o)</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>            : <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">m</a>(mm), <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">exponent</a>(expo), <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#ad9131acef5fa236edb8e506de5e7f3ec">origin</a>(o) {</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>            <a class="code hl_define" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">m</a>&gt;-2 and <a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">m</a>&lt;2);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>            <a class="code hl_define" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">exponent</a>&gt;0.0);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>        }</div>
</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="foldopen" id="foldopen00503" data-start="{" data-end="}">
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1p__orbital.html#a7d8097c3bde5e829965982afc393f924">  503</a></span>        <a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a> <a class="code hl_function" href="structmadness_1_1Znemo_1_1p__orbital.html#a7d8097c3bde5e829965982afc393f924">operator()</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; xyz1)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> xyz=xyz1-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#ad9131acef5fa236edb8e506de5e7f3ec">origin</a>;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>            <span class="keywordtype">double</span> r=xyz.<a class="code hl_function" href="classmadness_1_1Vector.html#a5aa070640348cc2f71587b2065f85d31">normf</a>();</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">m</a>==0) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                <span class="keywordtype">double</span> theta=acos(xyz[2]/r);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                <span class="comment">//double phi=atan2(xyz[1],xyz[0]);</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                <span class="keywordflow">return</span> r*exp(-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">exponent</a>*r)*cos(theta);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                <span class="keywordtype">double</span> theta=acos(xyz[2]/r);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                <span class="keywordtype">double</span> phi=atan2(xyz[1],xyz[0]);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>                <span class="keywordflow">return</span> r*exp(-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">exponent</a>*r)*sin(theta)*exp(<span class="keywordtype">double</span>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">m</a>)*<a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a>(0.0,1.0)*phi);</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>            }</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        }</div>
</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    };</div>
</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="comment"></span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="comment">    /// following Doucot Pascier 2005</span></div>
<div class="foldopen" id="foldopen00521" data-start="{" data-end="};">
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1landau__wave__function.html">  521</a></span><span class="comment"></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structmadness_1_1Znemo_1_1landau__wave__function.html">landau_wave_function</a> {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span> </div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">  523</a></span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">m</a>=0;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">  524</a></span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">l</a>=0.0;       <span class="comment">///&lt; radius Eq. (29)</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">  525</a></span>        <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">origin</a>={0.0,0.0,0.0};</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="foldopen" id="foldopen00527" data-start="{" data-end="}">
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1landau__wave__function.html#ad739ca0153337d91acbea3943636e99a">  527</a></span>        <a class="code hl_function" href="structmadness_1_1Znemo_1_1landau__wave__function.html#ad739ca0153337d91acbea3943636e99a">landau_wave_function</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">m</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_class" href="classB.html">B</a>,</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">origin</a>={0.0,0.0,0.0})</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            : <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">m</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">m</a>), <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">l</a>(1.0/sqrt(<a class="code hl_class" href="classB.html">B</a>)), <a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">origin</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">origin</a>) {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>            <a class="code hl_function" href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">print</a>(<span class="stringliteral">&quot;origin&quot;</span>,<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">origin</a>);</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            <a class="code hl_define" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">m</a>&gt;=0);</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            <a class="code hl_define" href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a>(<a class="code hl_class" href="classB.html">B</a>&gt;0);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        }</div>
</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span><span class="comment"></span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span><span class="comment">        /// following Eq. (43)</span></div>
<div class="foldopen" id="foldopen00536" data-start="{" data-end="}">
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno"><a class="line" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a5e8e8674407c9709dd61fa0a4741bb8b">  536</a></span><span class="comment"></span>        <a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a> <a class="code hl_function" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a5e8e8674407c9709dd61fa0a4741bb8b">operator()</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a>&amp; xyz1)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            <span class="keyword">const</span> <a class="code hl_class" href="classmadness_1_1Vector.html">coord_3d</a> xyz=xyz1-<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">origin</a>;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a> z(xyz[0],xyz[1]);          <span class="comment">// z = x + iy</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a> zbar(xyz[0],-xyz[1]);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span> </div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>            <span class="keywordtype">double</span> z_confinement=exp(-0.01*xyz[2]);     <span class="comment">// make wf decay in z-direction</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>            <span class="keywordflow">return</span> std::pow(zbar/<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">l</a>,<span class="keywordtype">double</span>(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">m</a>)) * exp(-0.25*zbar*z/(<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">l</a>*<a class="code hl_variable" href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">l</a>)) * z_confinement;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        }</div>
</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    };</div>
</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a700673973af09f0905837d142dda8117">test_compute_current_density</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmadness_1_1Znemo.html#a4b94a66e91178e453de8a617f0a74f02">test_landau_wave_function</a>();</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>};</div>
</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>} <span class="comment">// namespace madness</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="preprocessor">#endif </span><span class="comment">/* SRC_APPS_CHEM_ZNEMO_H_ */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aCalculationParameters_8h_html"><div class="ttname"><a href="CalculationParameters_8h.html">CalculationParameters.h</a></div></div>
<div class="ttc" id="aDKops_8h_html_a2508e63045d8be6e94a968aa8aec0a32"><div class="ttname"><a href="DKops_8h.html#a2508e63045d8be6e94a968aa8aec0a32">w</a></div><div class="ttdeci">double w(double t, double eps)</div><div class="ttdef"><b>Definition</b> DKops.h:22</div></div>
<div class="ttc" id="aMolecularOrbitals_8h_html"><div class="ttname"><a href="MolecularOrbitals_8h.html">MolecularOrbitals.h</a></div></div>
<div class="ttc" id="aQCCalculationParametersBase_8h_html"><div class="ttname"><a href="QCCalculationParametersBase_8h.html">QCCalculationParametersBase.h</a></div></div>
<div class="ttc" id="aSCFOperators_8h_html"><div class="ttname"><a href="SCFOperators_8h.html">SCFOperators.h</a></div><div class="ttdoc">Operators for the molecular HF and DFT code.</div></div>
<div class="ttc" id="acfft_8h_html_a6baa3069271c5feb35d2cb2dec51e256"><div class="ttname"><a href="cfft_8h.html#a6baa3069271c5feb35d2cb2dec51e256">double_complex</a></div><div class="ttdeci">std::complex&lt; double &gt; double_complex</div><div class="ttdef"><b>Definition</b> cfft.h:14</div></div>
<div class="ttc" id="aclassA_html"><div class="ttname"><a href="classA.html">A</a></div><div class="ttdef"><b>Definition</b> test_ar.cc:118</div></div>
<div class="ttc" id="aclassB_html"><div class="ttname"><a href="classB.html">B</a></div><div class="ttdef"><b>Definition</b> test_ar.cc:141</div></div>
<div class="ttc" id="aclassmadness_1_1AtomicBasisSet_html"><div class="ttname"><a href="classmadness_1_1AtomicBasisSet.html">madness::AtomicBasisSet</a></div><div class="ttdoc">Contracted Gaussian basis.</div><div class="ttdef"><b>Definition</b> madness/chem/molecularbasis.h:469</div></div>
<div class="ttc" id="aclassmadness_1_1FunctionDefaults_html_a3fc8a34a12e6078b1cc9fd2a57bcf4d2"><div class="ttname"><a href="classmadness_1_1FunctionDefaults.html#a3fc8a34a12e6078b1cc9fd2a57bcf4d2">madness::FunctionDefaults::get_thresh</a></div><div class="ttdeci">static const double &amp; get_thresh()</div><div class="ttdoc">Returns the default threshold.</div><div class="ttdef"><b>Definition</b> funcdefaults.h:177</div></div>
<div class="ttc" id="aclassmadness_1_1FunctionFunctorInterface_html"><div class="ttname"><a href="classmadness_1_1FunctionFunctorInterface.html">madness::FunctionFunctorInterface</a></div><div class="ttdoc">Abstract base class interface required for functors used as input to Functions.</div><div class="ttdef"><b>Definition</b> function_interface.h:68</div></div>
<div class="ttc" id="aclassmadness_1_1Function_html"><div class="ttname"><a href="classmadness_1_1Function.html">madness::Function&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="aclassmadness_1_1Function_html_a1b4d69841a957d0cbd25948f70d81a2d"><div class="ttname"><a href="classmadness_1_1Function.html#a1b4d69841a957d0cbd25948f70d81a2d">madness::Function::scale</a></div><div class="ttdeci">Function&lt; T, NDIM &gt; &amp; scale(const Q q, bool fence=true)</div><div class="ttdoc">Inplace, scale the function by a constant. No communication except for optional fence.</div><div class="ttdef"><b>Definition</b> mra.h:1025</div></div>
<div class="ttc" id="aclassmadness_1_1MolecularOrbitals_html"><div class="ttname"><a href="classmadness_1_1MolecularOrbitals.html">madness::MolecularOrbitals</a></div><div class="ttdef"><b>Definition</b> MolecularOrbitals.h:24</div></div>
<div class="ttc" id="aclassmadness_1_1MolecularOrbitals_html_a0ddf92975e3c9266e808cc8013db00bd"><div class="ttname"><a href="classmadness_1_1MolecularOrbitals.html#a0ddf92975e3c9266e808cc8013db00bd">madness::MolecularOrbitals::save_restartaodata</a></div><div class="ttdeci">static void save_restartaodata(World &amp;world, const Molecule &amp;molecule, const MolecularOrbitals&lt; T, NDIM &gt; &amp;amo, const MolecularOrbitals&lt; T, NDIM &gt; &amp;bmo, const AtomicBasisSet &amp;aobasis)</div><div class="ttdoc">save MOs in the AO projection for geometry restart</div><div class="ttdef"><b>Definition</b> MolecularOrbitals.cc:83</div></div>
<div class="ttc" id="aclassmadness_1_1MolecularOrbitals_html_aa4bff2b25ac8ba47ce94b22f722bcb8d"><div class="ttname"><a href="classmadness_1_1MolecularOrbitals.html#aa4bff2b25ac8ba47ce94b22f722bcb8d">madness::MolecularOrbitals::update_mos_and_eps</a></div><div class="ttdeci">MolecularOrbitals &amp; update_mos_and_eps(const std::vector&lt; Function&lt; T, NDIM &gt; &gt; &amp;mo_new, const Tensor&lt; double &gt; &amp;eps_new)</div><div class="ttdoc">updates will keep other member variables</div><div class="ttdef"><b>Definition</b> MolecularOrbitals.h:109</div></div>
<div class="ttc" id="aclassmadness_1_1Molecule_html"><div class="ttname"><a href="classmadness_1_1Molecule.html">madness::Molecule</a></div><div class="ttdef"><b>Definition</b> molecule.h:129</div></div>
<div class="ttc" id="aclassmadness_1_1Molecule_html_a4ba7e8c61bc08da5db2041e64ba7be3d"><div class="ttname"><a href="classmadness_1_1Molecule.html#a4ba7e8c61bc08da5db2041e64ba7be3d">madness::Molecule::get_all_coords</a></div><div class="ttdeci">madness::Tensor&lt; double &gt; get_all_coords() const</div><div class="ttdef"><b>Definition</b> molecule.cc:402</div></div>
<div class="ttc" id="aclassmadness_1_1Molecule_html_ab02e99ae776d968ff248ff2f51e28532"><div class="ttname"><a href="classmadness_1_1Molecule.html#ab02e99ae776d968ff248ff2f51e28532">madness::Molecule::print_parameters</a></div><div class="ttdeci">static void print_parameters()</div><div class="ttdef"><b>Definition</b> molecule.cc:115</div></div>
<div class="ttc" id="aclassmadness_1_1NemoBase_html"><div class="ttname"><a href="classmadness_1_1NemoBase.html">madness::NemoBase</a></div><div class="ttdef"><b>Definition</b> nemo.h:69</div></div>
<div class="ttc" id="aclassmadness_1_1NemoBase_html_a7b60617da931bb25f9e43c5a06ce3b24"><div class="ttname"><a href="classmadness_1_1NemoBase.html#a7b60617da931bb25f9e43c5a06ce3b24">madness::NemoBase::compute_density</a></div><div class="ttdeci">Function&lt; typename Tensor&lt; T &gt;::scalar_type, NDIM &gt; compute_density(const std::vector&lt; Function&lt; T, NDIM &gt; &gt; nemo) const</div><div class="ttdef"><b>Definition</b> nemo.h:139</div></div>
<div class="ttc" id="aclassmadness_1_1NemoBase_html_adb6cfd90062f9fd93bc102f254ec659b"><div class="ttname"><a href="classmadness_1_1NemoBase.html#adb6cfd90062f9fd93bc102f254ec659b">madness::NemoBase::world</a></div><div class="ttdeci">World &amp; world</div><div class="ttdef"><b>Definition</b> nemo.h:310</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html">madness::Nemo_complex_Parameters</a></div><div class="ttdef"><b>Definition</b> znemo.h:56</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a04d8b52b0eb76bdc205d51d7f1354a12"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a04d8b52b0eb76bdc205d51d7f1354a12">madness::Nemo_complex_Parameters::guess</a></div><div class="ttdeci">std::vector&lt; std::string &gt; guess() const</div><div class="ttdef"><b>Definition</b> znemo.h:104</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a0787b664514eaaa8898f3d99aeb5fa1a"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a0787b664514eaaa8898f3d99aeb5fa1a">madness::Nemo_complex_Parameters::get_tag</a></div><div class="ttdeci">std::string get_tag() const override</div><div class="ttdef"><b>Definition</b> znemo.h:77</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a08b762233b3a5bfa6f006be16a1c4311"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a08b762233b3a5bfa6f006be16a1c4311">madness::Nemo_complex_Parameters::Nemo_complex_Parameters</a></div><div class="ttdeci">Nemo_complex_Parameters()</div><div class="ttdoc">ctor reading out the input file</div><div class="ttdef"><b>Definition</b> znemo.h:60</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a2d91b942aa3a78ac7000d50b2de1ee01"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a2d91b942aa3a78ac7000d50b2de1ee01">madness::Nemo_complex_Parameters::printlevel</a></div><div class="ttdeci">int printlevel() const</div><div class="ttdef"><b>Definition</b> znemo.h:97</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a4de09727f73bc13c75bae044137dd473"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a4de09727f73bc13c75bae044137dd473">madness::Nemo_complex_Parameters::guess_functions</a></div><div class="ttdeci">std::vector&lt; std::string &gt; guess_functions() const</div><div class="ttdef"><b>Definition</b> znemo.h:105</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a5ce5da00ff1538800c750b53e84a0c20"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a5ce5da00ff1538800c750b53e84a0c20">madness::Nemo_complex_Parameters::box</a></div><div class="ttdeci">std::vector&lt; double &gt; box() const</div><div class="ttdef"><b>Definition</b> znemo.h:101</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a76b4d557cb2b564fe8d7cb073d7a6641"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a76b4d557cb2b564fe8d7cb073d7a6641">madness::Nemo_complex_Parameters::shift</a></div><div class="ttdeci">double shift() const</div><div class="ttdef"><b>Definition</b> znemo.h:98</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a83c09a3f30876b911bce5d818cc9b699"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a83c09a3f30876b911bce5d818cc9b699">madness::Nemo_complex_Parameters::Nemo_complex_Parameters</a></div><div class="ttdeci">Nemo_complex_Parameters(World &amp;world, const commandlineparser &amp;parser)</div><div class="ttdef"><b>Definition</b> znemo.h:72</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_a89247ac2588f48b4ffe83baaac5074e0"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#a89247ac2588f48b4ffe83baaac5074e0">madness::Nemo_complex_Parameters::use_v_vector</a></div><div class="ttdeci">bool use_v_vector() const</div><div class="ttdef"><b>Definition</b> znemo.h:103</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_ab3c3d651162a9f929f9e20cb341e7b64"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#ab3c3d651162a9f929f9e20cb341e7b64">madness::Nemo_complex_Parameters::physical_B</a></div><div class="ttdeci">double physical_B() const</div><div class="ttdef"><b>Definition</b> znemo.h:99</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_abeb9ee67835ee08dc430ba7576fb3bb2"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#abeb9ee67835ee08dc430ba7576fb3bb2">madness::Nemo_complex_Parameters::explicit_B</a></div><div class="ttdeci">double explicit_B() const</div><div class="ttdef"><b>Definition</b> znemo.h:100</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_ad3b27c7466fe7f96ec0154fddc625923"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#ad3b27c7466fe7f96ec0154fddc625923">madness::Nemo_complex_Parameters::potential_radius</a></div><div class="ttdeci">double potential_radius() const</div><div class="ttdef"><b>Definition</b> znemo.h:102</div></div>
<div class="ttc" id="aclassmadness_1_1Nemo__complex__Parameters_html_aef4216f09d0a1a8cc0112734c293dd19"><div class="ttname"><a href="classmadness_1_1Nemo__complex__Parameters.html#aef4216f09d0a1a8cc0112734c293dd19">madness::Nemo_complex_Parameters::set_derived_values</a></div><div class="ttdeci">void set_derived_values()</div><div class="ttdef"><b>Definition</b> znemo.h:81</div></div>
<div class="ttc" id="aclassmadness_1_1QCCalculationParametersBase_html"><div class="ttname"><a href="classmadness_1_1QCCalculationParametersBase.html">madness::QCCalculationParametersBase</a></div><div class="ttdoc">class for holding the parameters for calculation</div><div class="ttdef"><b>Definition</b> QCCalculationParametersBase.h:295</div></div>
<div class="ttc" id="aclassmadness_1_1QCCalculationParametersBase_html_a0cff12488c973bc263aecfb2b3fdac26"><div class="ttname"><a href="classmadness_1_1QCCalculationParametersBase.html#a0cff12488c973bc263aecfb2b3fdac26">madness::QCCalculationParametersBase::read_input_and_commandline_options</a></div><div class="ttdeci">void read_input_and_commandline_options(World &amp;world, const commandlineparser &amp;parser, const std::string tag)</div><div class="ttdef"><b>Definition</b> QCCalculationParametersBase.h:331</div></div>
<div class="ttc" id="aclassmadness_1_1QCCalculationParametersBase_html_a84045c85e4fa94fdd992f87713572b4d"><div class="ttname"><a href="classmadness_1_1QCCalculationParametersBase.html#a84045c85e4fa94fdd992f87713572b4d">madness::QCCalculationParametersBase::print</a></div><div class="ttdeci">void print(const std::string header=&quot;&quot;, const std::string footer=&quot;&quot;) const</div><div class="ttdoc">print all parameters</div><div class="ttdef"><b>Definition</b> QCCalculationParametersBase.cc:22</div></div>
<div class="ttc" id="aclassmadness_1_1QCCalculationParametersBase_html_af53065bc29d6ef85e77cf1af000233d5"><div class="ttname"><a href="classmadness_1_1QCCalculationParametersBase.html#af53065bc29d6ef85e77cf1af000233d5">madness::QCCalculationParametersBase::set_derived_value</a></div><div class="ttdeci">void set_derived_value(const std::string &amp;key, const T &amp;value)</div><div class="ttdef"><b>Definition</b> QCCalculationParametersBase.h:409</div></div>
<div class="ttc" id="aclassmadness_1_1QCPropertyInterface_html"><div class="ttname"><a href="classmadness_1_1QCPropertyInterface.html">madness::QCPropertyInterface</a></div><div class="ttdoc">class implementing properties of QC models</div><div class="ttdef"><b>Definition</b> QCPropertyInterface.h:11</div></div>
<div class="ttc" id="aclassmadness_1_1QCPropertyInterface_html_aac300cae6fb5a86846d48b2343a00f68"><div class="ttname"><a href="classmadness_1_1QCPropertyInterface.html#aac300cae6fb5a86846d48b2343a00f68">madness::QCPropertyInterface::density</a></div><div class="ttdeci">virtual real_function_3d density() const</div><div class="ttdef"><b>Definition</b> QCPropertyInterface.h:25</div></div>
<div class="ttc" id="aclassmadness_1_1Tensor_html"><div class="ttname"><a href="classmadness_1_1Tensor.html">madness::Tensor</a></div><div class="ttdoc">A tensor is a multidimensional array.</div><div class="ttdef"><b>Definition</b> tensor.h:317</div></div>
<div class="ttc" id="aclassmadness_1_1Vector_html"><div class="ttname"><a href="classmadness_1_1Vector.html">madness::Vector&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="aclassmadness_1_1Vector_html_a5aa070640348cc2f71587b2065f85d31"><div class="ttname"><a href="classmadness_1_1Vector.html#a5aa070640348cc2f71587b2065f85d31">madness::Vector::normf</a></div><div class="ttdeci">constexpr T normf() const</div><div class="ttdoc">Calculate the 2-norm of the vector elements.</div><div class="ttdef"><b>Definition</b> vector.h:421</div></div>
<div class="ttc" id="aclassmadness_1_1WorldGopInterface_html_a38629ed5c3a209def2a35ac8eb8ce336"><div class="ttname"><a href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">madness::WorldGopInterface::fence</a></div><div class="ttdeci">void fence(bool debug=false)</div><div class="ttdoc">Synchronizes all processes in communicator AND globally ensures no pending AM or tasks.</div><div class="ttdef"><b>Definition</b> worldgop.cc:161</div></div>
<div class="ttc" id="aclassmadness_1_1World_html"><div class="ttname"><a href="classmadness_1_1World.html">madness::World</a></div><div class="ttdoc">A parallel world class.</div><div class="ttdef"><b>Definition</b> world.h:132</div></div>
<div class="ttc" id="aclassmadness_1_1World_html_a6cb4bff7804dc04970620fa61acd7876"><div class="ttname"><a href="classmadness_1_1World.html#a6cb4bff7804dc04970620fa61acd7876">madness::World::rank</a></div><div class="ttdeci">ProcessID rank() const</div><div class="ttdoc">Returns the process rank in this World (same as MPI_Comm_rank()).</div><div class="ttdef"><b>Definition</b> world.h:320</div></div>
<div class="ttc" id="aclassmadness_1_1World_html_ac38c53af9794c1b1c7c6e00c7399705f"><div class="ttname"><a href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">madness::World::gop</a></div><div class="ttdeci">WorldGopInterface &amp; gop</div><div class="ttdoc">Global operations.</div><div class="ttdef"><b>Definition</b> world.h:207</div></div>
<div class="ttc" id="aclassmadness_1_1XNonlinearSolver_html"><div class="ttname"><a href="classmadness_1_1XNonlinearSolver.html">madness::XNonlinearSolver</a></div><div class="ttdoc">Generalized version of NonlinearSolver not limited to a single madness function.</div><div class="ttdef"><b>Definition</b> nonlinsol.h:207</div></div>
<div class="ttc" id="aclassmadness_1_1Zcis_html"><div class="ttname"><a href="classmadness_1_1Zcis.html">madness::Zcis</a></div><div class="ttdef"><b>Definition</b> zcis.h:67</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html"><div class="ttname"><a href="classmadness_1_1Znemo.html">madness::Znemo</a></div><div class="ttdef"><b>Definition</b> znemo.h:110</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a07cb2cb9abcdeb6d1f9e603bdf08caad"><div class="ttname"><a href="classmadness_1_1Znemo.html#a07cb2cb9abcdeb6d1f9e603bdf08caad">madness::Znemo::aobasis</a></div><div class="ttdeci">AtomicBasisSet aobasis</div><div class="ttdef"><b>Definition</b> znemo.h:445</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a0882b1047ce5bb92fa5712d678f9b1ec"><div class="ttname"><a href="classmadness_1_1Znemo.html#a0882b1047ce5bb92fa5712d678f9b1ec">madness::Znemo::print_info</a></div><div class="ttdeci">printleveler print_info</div><div class="ttdef"><b>Definition</b> znemo.h:446</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a0dcc8df1b11dfa1016ba0805e030f922"><div class="ttname"><a href="classmadness_1_1Znemo.html#a0dcc8df1b11dfa1016ba0805e030f922">madness::Znemo::molecule</a></div><div class="ttdeci">Molecule &amp; molecule() override</div><div class="ttdoc">return the molecule of the target</div><div class="ttdef"><b>Definition</b> znemo.h:232</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a0e095f9500a5f3582a267a457fd84a97"><div class="ttname"><a href="classmadness_1_1Znemo.html#a0e095f9500a5f3582a267a457fd84a97">madness::Znemo::diafac</a></div><div class="ttdeci">std::shared_ptr&lt; Diamagnetic_potential_factor &gt; diafac</div><div class="ttdef"><b>Definition</b> znemo.h:452</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a104720c700bd16ceee7ed803c4da6728"><div class="ttname"><a href="classmadness_1_1Znemo.html#a104720c700bd16ceee7ed803c4da6728">madness::Znemo::aeps</a></div><div class="ttdeci">Tensor&lt; double &gt; aeps</div><div class="ttdoc">the orbital energies</div><div class="ttdef"><b>Definition</b> znemo.h:464</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a1ac6e9d61111880b9cfbdbf2c40f82e9"><div class="ttname"><a href="classmadness_1_1Znemo.html#a1ac6e9d61111880b9cfbdbf2c40f82e9">madness::Znemo::rvec</a></div><div class="ttdeci">std::vector&lt; real_function_3d &gt; rvec</div><div class="ttdoc">the linear moments r={x,y,z}</div><div class="ttdef"><b>Definition</b> znemo.h:470</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a1b210d8c1169c2d4153e8aebec0a6226"><div class="ttname"><a href="classmadness_1_1Znemo.html#a1b210d8c1169c2d4153e8aebec0a6226">madness::Znemo::do_step_restriction</a></div><div class="ttdeci">void do_step_restriction(const std::vector&lt; complex_function_3d &gt; &amp;mo, std::vector&lt; complex_function_3d &gt; &amp;mo_new) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:747</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a21ebbe19a68192675c0d27482134ec75"><div class="ttname"><a href="classmadness_1_1Znemo.html#a21ebbe19a68192675c0d27482134ec75">madness::Znemo::compute_potentials</a></div><div class="ttdeci">potentials compute_potentials(const std::vector&lt; complex_function_3d &gt; &amp;mo, const real_function_3d &amp;density, const std::vector&lt; complex_function_3d &gt; &amp;rhs) const</div><div class="ttdoc">compute the potential operators applied on the orbitals</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:1064</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a248145bc6215e59b2f0dc5f0acfe79eb"><div class="ttname"><a href="classmadness_1_1Znemo.html#a248145bc6215e59b2f0dc5f0acfe79eb">madness::Znemo::rotate_subspace</a></div><div class="ttdeci">void rotate_subspace(const Tensor&lt; double_complex &gt; &amp;U, solverT &amp;solver) const</div><div class="ttdoc">rotate the KAIN subspace (cf. SCF.cc)</div><div class="ttdef"><b>Definition</b> znemo.h:364</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a2638afd736e2de41b6bfc8c43d2c65e0"><div class="ttname"><a href="classmadness_1_1Znemo.html#a2638afd736e2de41b6bfc8c43d2c65e0">madness::Znemo::compute_residuals</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; compute_residuals(const std::vector&lt; complex_function_3d &gt; &amp;Vpsi, const std::vector&lt; complex_function_3d &gt; &amp;psi, Tensor&lt; double &gt; &amp;eps, const double levelshift=0.0) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:1125</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a2b0f368d022b5eecafaf355854d763b4"><div class="ttname"><a href="classmadness_1_1Znemo.html#a2b0f368d022b5eecafaf355854d763b4">madness::Znemo::get_calc_param</a></div><div class="ttdeci">const CalculationParameters &amp; get_calc_param() const</div><div class="ttdef"><b>Definition</b> znemo.h:231</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a2f2d6ad046923b0735260bb54a269514"><div class="ttname"><a href="classmadness_1_1Znemo.html#a2f2d6ad046923b0735260bb54a269514">madness::Znemo::read_real_guess</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; read_real_guess() const</div><div class="ttdoc">read the guess orbitals from a previous nemo or moldft calculation</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:849</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a2f63ad97b890ce8d2e1ca697ee1ba1a0"><div class="ttname"><a href="classmadness_1_1Znemo.html#a2f63ad97b890ce8d2e1ca697ee1ba1a0">madness::Znemo::compute_energy</a></div><div class="ttdeci">double compute_energy(const std::vector&lt; complex_function_3d &gt; &amp;amo, const potentials &amp;apot, const std::vector&lt; complex_function_3d &gt; &amp;bmo, const potentials &amp;bpot, const bool do_print, const bool no_confinement) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:535</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a32b08f72c29469bd85367ef7b48ba822"><div class="ttname"><a href="classmadness_1_1Znemo.html#a32b08f72c29469bd85367ef7b48ba822">madness::Znemo::read_reference</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; read_reference() const</div><div class="ttdoc">read orbitals from a znemo calculation</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:938</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a337c947c6b07da4096768f03d0a50b47"><div class="ttname"><a href="classmadness_1_1Znemo.html#a337c947c6b07da4096768f03d0a50b47">madness::Znemo::amo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; amo</div><div class="ttdoc">the molecular orbitals – alpha</div><div class="ttdef"><b>Definition</b> znemo.h:461</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a34888143e61570a2ef5156f08e5f818c"><div class="ttname"><a href="classmadness_1_1Znemo.html#a34888143e61570a2ef5156f08e5f818c">madness::Znemo::read_restartaodata</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; read_restartaodata() const</div><div class="ttdoc">read guess as projection of the orbitals onto an AO basis set (for geometry optimization)</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:918</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a35700bb81dbfed953cba0a124d5cbb5d"><div class="ttname"><a href="classmadness_1_1Znemo.html#a35700bb81dbfed953cba0a124d5cbb5d">madness::Znemo::test_U_potentials</a></div><div class="ttdeci">bool test_U_potentials() const</div><div class="ttdoc">test the identity &lt;F| f (T + Vdia ) f |F&gt; = &lt;F|f^2 (T + Udia) |F&gt;</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:115</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a397b9f2602a2465588edab2fb092ccae"><div class="ttname"><a href="classmadness_1_1Znemo.html#a397b9f2602a2465588edab2fb092ccae">madness::Znemo::beps</a></div><div class="ttdeci">Tensor&lt; double &gt; beps</div><div class="ttdef"><b>Definition</b> znemo.h:464</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a406d9ab2851b633105609c937c0f42d0"><div class="ttname"><a href="classmadness_1_1Znemo.html#a406d9ab2851b633105609c937c0f42d0">madness::Znemo::compute_standard_gauge_shift</a></div><div class="ttdeci">Tensor&lt; double &gt; compute_standard_gauge_shift(const Tensor&lt; double &gt; &amp;p_exp) const</div><div class="ttdoc">compute the shift of the molecule such that the kinetic momentum vanishes</div><div class="ttdef"><b>Definition</b> znemo.h:273</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a4b94a66e91178e453de8a617f0a74f02"><div class="ttname"><a href="classmadness_1_1Znemo.html#a4b94a66e91178e453de8a617f0a74f02">madness::Znemo::test_landau_wave_function</a></div><div class="ttdeci">void test_landau_wave_function()</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:719</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a4f6565b72915d58a225cf517d80cfc94"><div class="ttname"><a href="classmadness_1_1Znemo.html#a4f6565b72915d58a225cf517d80cfc94">madness::Znemo::need_recompute_factors_and_potentials</a></div><div class="ttdeci">bool need_recompute_factors_and_potentials(const double thresh) const override</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:56</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a5002eb04c90955caa0bed9fa0da15c4d"><div class="ttname"><a href="classmadness_1_1Znemo.html#a5002eb04c90955caa0bed9fa0da15c4d">madness::Znemo::output_calc_info_schema</a></div><div class="ttdeci">void output_calc_info_schema(const double &amp;energy) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:174</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a5bf8107836bb648ddc0f02d94f197f11"><div class="ttname"><a href="classmadness_1_1Znemo.html#a5bf8107836bb648ddc0f02d94f197f11">madness::Znemo::name</a></div><div class="ttdeci">std::string name() const override</div><div class="ttdef"><b>Definition</b> znemo.h:187</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a5e54cba39bbb75c7cf50e238a20a874d"><div class="ttname"><a href="classmadness_1_1Znemo.html#a5e54cba39bbb75c7cf50e238a20a874d">madness::Znemo::sbox</a></div><div class="ttdeci">real_function_3d sbox</div><div class="ttdoc">the spherical damping box</div><div class="ttdef"><b>Definition</b> znemo.h:467</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a605e9f6fc76c0d9ee87bb67c3b5d022f"><div class="ttname"><a href="classmadness_1_1Znemo.html#a605e9f6fc76c0d9ee87bb67c3b5d022f">madness::Znemo::iterate</a></div><div class="ttdeci">void iterate()</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:206</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a664375d3ee579cfccbca8b92bbe9191e"><div class="ttname"><a href="classmadness_1_1Znemo.html#a664375d3ee579cfccbca8b92bbe9191e">madness::Znemo::make_bra</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; make_bra(const std::vector&lt; complex_function_3d &gt; &amp;mo) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:359</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a6be8a7102f97e39a78e4f1d4a1320417"><div class="ttname"><a href="classmadness_1_1Znemo.html#a6be8a7102f97e39a78e4f1d4a1320417">madness::Znemo::have_beta</a></div><div class="ttdeci">bool have_beta() const</div><div class="ttdoc">are there explicit beta orbitals</div><div class="ttdef"><b>Definition</b> znemo.h:305</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a6e24931824c75cfd857353156da72c78"><div class="ttname"><a href="classmadness_1_1Znemo.html#a6e24931824c75cfd857353156da72c78">madness::Znemo::bmo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; bmo</div><div class="ttdef"><b>Definition</b> znemo.h:461</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a700673973af09f0905837d142dda8117"><div class="ttname"><a href="classmadness_1_1Znemo.html#a700673973af09f0905837d142dda8117">madness::Znemo::test_compute_current_density</a></div><div class="ttdeci">void test_compute_current_density() const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:701</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a71070a9df0c9ac6ac85d6ffd36fcffd0"><div class="ttname"><a href="classmadness_1_1Znemo.html#a71070a9df0c9ac6ac85d6ffd36fcffd0">madness::Znemo::compute_kinetic_momentum</a></div><div class="ttdeci">Tensor&lt; double &gt; compute_kinetic_momentum() const</div><div class="ttdoc">compute the expectation value of the kinetic momentum p</div><div class="ttdef"><b>Definition</b> znemo.h:244</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a76cc6c3696b6da16acb9bdbd3b3844d2"><div class="ttname"><a href="classmadness_1_1Znemo.html#a76cc6c3696b6da16acb9bdbd3b3844d2">madness::Znemo::compute_magnetic_potential_expectation</a></div><div class="ttdeci">Tensor&lt; double &gt; compute_magnetic_potential_expectation(const std::vector&lt; real_function_3d &gt; &amp;A) const</div><div class="ttdoc">compute the expectation value of the magnetic vector potential A</div><div class="ttdef"><b>Definition</b> znemo.h:265</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a78bb27dbb916cd35c98af58a8b84e758"><div class="ttname"><a href="classmadness_1_1Znemo.html#a78bb27dbb916cd35c98af58a8b84e758">madness::Znemo::B</a></div><div class="ttdeci">coord_3d B</div><div class="ttdoc">the magnetic field B=rot(A)</div><div class="ttdef"><b>Definition</b> znemo.h:455</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a791a92973074002eca7f706a49127148"><div class="ttname"><a href="classmadness_1_1Znemo.html#a791a92973074002eca7f706a49127148">madness::Znemo::read_explicit_guess_functions</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; read_explicit_guess_functions() const</div><div class="ttdoc">read a list of functions for the guess</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:892</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a7d79347aab059bcb2b111d5cfe1788a4"><div class="ttname"><a href="classmadness_1_1Znemo.html#a7d79347aab059bcb2b111d5cfe1788a4">madness::Znemo::orthonormalize</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; orthonormalize(const std::vector&lt; complex_function_3d &gt; &amp;mo) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:336</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a8110755fc79a66af89f492c318319b22"><div class="ttname"><a href="classmadness_1_1Znemo.html#a8110755fc79a66af89f492c318319b22">madness::Znemo::value</a></div><div class="ttdeci">double value()</div><div class="ttdoc">compute the molecular energy</div><div class="ttdef"><b>Definition</b> znemo.h:180</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a8825603982fc22bde04b7083df2905be"><div class="ttname"><a href="classmadness_1_1Znemo.html#a8825603982fc22bde04b7083df2905be">madness::Znemo::compute_density</a></div><div class="ttdeci">real_function_3d compute_density(const std::vector&lt; complex_function_3d &gt; &amp;amo, const std::vector&lt; complex_function_3d &gt; &amp;bmo) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:349</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a894c8462e21ea96561c1bd88d4482d20"><div class="ttname"><a href="classmadness_1_1Znemo.html#a894c8462e21ea96561c1bd88d4482d20">madness::Znemo::save_orbitals</a></div><div class="ttdeci">void save_orbitals() const</div><div class="ttdef"><b>Definition</b> znemo.h:341</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a8a291aaaae1b80b96e9638d5884ac51e"><div class="ttname"><a href="classmadness_1_1Znemo.html#a8a291aaaae1b80b96e9638d5884ac51e">madness::Znemo::nemo_param</a></div><div class="ttdeci">Nemo::NemoCalculationParameters nemo_param</div><div class="ttdoc">standard calculation parameters</div><div class="ttdef"><b>Definition</b> znemo.h:449</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a8d9dd938b8ca219806804261e001832c"><div class="ttname"><a href="classmadness_1_1Znemo.html#a8d9dd938b8ca219806804261e001832c">madness::Znemo::potentialmanager</a></div><div class="ttdeci">std::shared_ptr&lt; PotentialManager &gt; potentialmanager</div><div class="ttdoc">nuclear potential</div><div class="ttdef"><b>Definition</b> znemo.h:458</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a8fcc2b1b630b540929e14a0c03b5f653"><div class="ttname"><a href="classmadness_1_1Znemo.html#a8fcc2b1b630b540929e14a0c03b5f653">madness::Znemo::compute_nemo_spin_density</a></div><div class="ttdeci">real_function_3d compute_nemo_spin_density(const std::vector&lt; complex_function_3d &gt; &amp;amo, const std::vector&lt; complex_function_3d &gt; &amp;bmo) const</div><div class="ttdef"><b>Definition</b> znemo.h:421</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a9109d31192a479195217d393f2d1e6c4"><div class="ttname"><a href="classmadness_1_1Znemo.html#a9109d31192a479195217d393f2d1e6c4">madness::Znemo::get_initial_orbitals</a></div><div class="ttdeci">void get_initial_orbitals()</div><div class="ttdoc">get initial orbitals from guesses</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:771</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_a9ebf86f211f50efe4290ca8546d35da0"><div class="ttname"><a href="classmadness_1_1Znemo.html#a9ebf86f211f50efe4290ca8546d35da0">madness::Znemo::canonicalize</a></div><div class="ttdeci">void canonicalize(std::vector&lt; complex_function_3d &gt; &amp;amo, std::vector&lt; complex_function_3d &gt; &amp;vnemo, potentials &amp;pot, XNonlinearSolver&lt; std::vector&lt; complex_function_3d &gt;, double_complex, vector_function_allocator&lt; double_complex, 3 &gt; &gt; &amp;solver, Tensor&lt; double_complex &gt; fock, Tensor&lt; double_complex &gt; ovlp) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:1172</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_aaa79a16a4d6542bed8b503c32426c046"><div class="ttname"><a href="classmadness_1_1Znemo.html#aaa79a16a4d6542bed8b503c32426c046">madness::Znemo::compute_nemo_density</a></div><div class="ttdeci">real_function_3d compute_nemo_density(const std::vector&lt; complex_function_3d &gt; &amp;amo, const std::vector&lt; complex_function_3d &gt; &amp;bmo) const</div><div class="ttdef"><b>Definition</b> znemo.h:412</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_aab2c221c6d2dc61beff303f3f9cc2f2c"><div class="ttname"><a href="classmadness_1_1Znemo.html#aab2c221c6d2dc61beff303f3f9cc2f2c">madness::Znemo::coulop</a></div><div class="ttdeci">std::shared_ptr&lt; real_convolution_3d &gt; coulop</div><div class="ttdef"><b>Definition</b> znemo.h:472</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_aaebe821b6d46469c791b9cee0a0c170a"><div class="ttname"><a href="classmadness_1_1Znemo.html#aaebe821b6d46469c791b9cee0a0c170a">madness::Znemo::gradient</a></div><div class="ttdeci">Tensor&lt; double &gt; gradient()</div><div class="ttdef"><b>Definition</b> znemo.h:225</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ab1f5b0315ed2da5be4700bc474182c6f"><div class="ttname"><a href="classmadness_1_1Znemo.html#ab1f5b0315ed2da5be4700bc474182c6f">madness::Znemo::read_complex_guess</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; read_complex_guess() const</div><div class="ttdoc">read the guess orbitals from a previous nemo or moldft calculation</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:884</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ab90ee118f5422f1bf3b0601fd3059790"><div class="ttname"><a href="classmadness_1_1Znemo.html#ab90ee118f5422f1bf3b0601fd3059790">madness::Znemo::recompute_factors_and_potentials</a></div><div class="ttdeci">void recompute_factors_and_potentials(const double thresh)</div><div class="ttdoc">adapt the thresholds consistently to a common value</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:70</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_abe4acb8ff8437f8eacb64bcd19d7128b"><div class="ttname"><a href="classmadness_1_1Znemo.html#abe4acb8ff8437f8eacb64bcd19d7128b">madness::Znemo::compute_magnetic_vector_potential</a></div><div class="ttdeci">static std::vector&lt; real_function_3d &gt; compute_magnetic_vector_potential(World &amp;world, const coord_3d &amp;Bvec)</div><div class="ttdoc">compute the magnetic vector potential A</div><div class="ttdef"><b>Definition</b> znemo.h:290</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ac11e7b5c56da3d10a0d24279fe872f88"><div class="ttname"><a href="classmadness_1_1Znemo.html#ac11e7b5c56da3d10a0d24279fe872f88">madness::Znemo::compute_linear_moment</a></div><div class="ttdeci">Tensor&lt; double &gt; compute_linear_moment() const</div><div class="ttdoc">compute the expectation value of the linear moment r</div><div class="ttdef"><b>Definition</b> znemo.h:252</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ac1c6ae6af9c6182e2d95b2fca96462f7"><div class="ttname"><a href="classmadness_1_1Znemo.html#ac1c6ae6af9c6182e2d95b2fca96462f7">madness::Znemo::compute_spin_density</a></div><div class="ttdeci">real_function_3d compute_spin_density(const std::vector&lt; complex_function_3d &gt; &amp;amo, const std::vector&lt; complex_function_3d &gt; &amp;bmo) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:354</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ac2fc430ef425a3f9afb3216aba8b895f"><div class="ttname"><a href="classmadness_1_1Znemo.html#ac2fc430ef425a3f9afb3216aba8b895f">madness::Znemo::custom_guess</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; custom_guess() const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:963</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ac36abfca4832188baaaf4d21bab982f3"><div class="ttname"><a href="classmadness_1_1Znemo.html#ac36abfca4832188baaaf4d21bab982f3">madness::Znemo::print_parameters</a></div><div class="ttdeci">static void print_parameters()</div><div class="ttdef"><b>Definition</b> znemo.h:202</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ac629bfbe74311f192fec239149792f32"><div class="ttname"><a href="classmadness_1_1Znemo.html#ac629bfbe74311f192fec239149792f32">madness::Znemo::mol</a></div><div class="ttdeci">Molecule mol</div><div class="ttdef"><b>Definition</b> znemo.h:443</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_acd38fc459dba7b980bcd6cd9ee71eb68"><div class="ttname"><a href="classmadness_1_1Znemo.html#acd38fc459dba7b980bcd6cd9ee71eb68">madness::Znemo::compute_vmat</a></div><div class="ttdeci">Tensor&lt; double_complex &gt; compute_vmat(const std::vector&lt; complex_function_3d &gt; &amp;mo, const potentials &amp;pot) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:1105</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ad13b6868a1147feee75520be06c1b693"><div class="ttname"><a href="classmadness_1_1Znemo.html#ad13b6868a1147feee75520be06c1b693">madness::Znemo::invalidate_factors_and_potentials</a></div><div class="ttdeci">void invalidate_factors_and_potentials() override</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:64</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_addac25f4106e5d3df7836d1494545f03"><div class="ttname"><a href="classmadness_1_1Znemo.html#addac25f4106e5d3df7836d1494545f03">madness::Znemo::analyze</a></div><div class="ttdeci">double analyze()</div><div class="ttdoc">analyse the results only</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:364</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_adf7ac1c52deeac1ab5aa80e87fbe17e9"><div class="ttname"><a href="classmadness_1_1Znemo.html#adf7ac1c52deeac1ab5aa80e87fbe17e9">madness::Znemo::hcore_guess</a></div><div class="ttdeci">std::pair&lt; MolecularOrbitals&lt; double_complex, 3 &gt;, MolecularOrbitals&lt; double_complex, 3 &gt; &gt; hcore_guess() const</div><div class="ttdoc">hcore guess including the magnetic field</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:1002</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ae174cfb20531f395ac5ded0343cd74b5"><div class="ttname"><a href="classmadness_1_1Znemo.html#ae174cfb20531f395ac5ded0343cd74b5">madness::Znemo::selftest</a></div><div class="ttdeci">bool selftest() override</div><div class="ttdef"><b>Definition</b> znemo.h:212</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ae22a44d7521d15baa736bd735ffc21d7"><div class="ttname"><a href="classmadness_1_1Znemo.html#ae22a44d7521d15baa736bd735ffc21d7">madness::Znemo::help</a></div><div class="ttdeci">static void help()</div><div class="ttdef"><b>Definition</b> znemo.h:189</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ae8459d714cfeb7737939113810452850"><div class="ttname"><a href="classmadness_1_1Znemo.html#ae8459d714cfeb7737939113810452850">madness::Znemo::calc_param</a></div><div class="ttdeci">CalculationParameters calc_param</div><div class="ttdef"><b>Definition</b> znemo.h:450</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_ae84a8162cdf6462a927124221c0a6e80"><div class="ttname"><a href="classmadness_1_1Znemo.html#ae84a8162cdf6462a927124221c0a6e80">madness::Znemo::normalize</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; normalize(const std::vector&lt; complex_function_3d &gt; &amp;mo) const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:342</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_aeb6ae33e799ce690bec15d8d436d2960"><div class="ttname"><a href="classmadness_1_1Znemo.html#aeb6ae33e799ce690bec15d8d436d2960">madness::Znemo::test</a></div><div class="ttdeci">bool test() const</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:102</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_aee1b16196826d19e0c579ba4b856b972"><div class="ttname"><a href="classmadness_1_1Znemo.html#aee1b16196826d19e0c579ba4b856b972">madness::Znemo::param</a></div><div class="ttdeci">Nemo_complex_Parameters param</div><div class="ttdef"><b>Definition</b> znemo.h:444</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_af34dd775886b5397cf770b3a94bd1e7b"><div class="ttname"><a href="classmadness_1_1Znemo.html#af34dd775886b5397cf770b3a94bd1e7b">madness::Znemo::molecule</a></div><div class="ttdeci">const Molecule &amp; molecule() const</div><div class="ttdef"><b>Definition</b> znemo.h:233</div></div>
<div class="ttc" id="aclassmadness_1_1Znemo_html_af4f6efa6ad411cd427598854eea2600a"><div class="ttname"><a href="classmadness_1_1Znemo.html#af4f6efa6ad411cd427598854eea2600a">madness::Znemo::compute_current_density</a></div><div class="ttdeci">std::vector&lt; real_function_3d &gt; compute_current_density(const std::vector&lt; complex_function_3d &gt; &amp;alpha_mo, const std::vector&lt; complex_function_3d &gt; &amp;beta_mo) const</div><div class="ttdoc">compute the current density</div><div class="ttdef"><b>Definition</b> madness/chem/znemo.cc:630</div></div>
<div class="ttc" id="aclassmadness_1_1archive_1_1ParallelOutputArchive_html"><div class="ttname"><a href="classmadness_1_1archive_1_1ParallelOutputArchive.html">madness::archive::ParallelOutputArchive</a></div><div class="ttdoc">An archive for storing local or parallel data wrapping a BinaryFstreamOutputArchive.</div><div class="ttdef"><b>Definition</b> parallel_archive.h:321</div></div>
<div class="ttc" id="aderivatives_8cc_html_a423df6189110b25bb1b2836671974b25"><div class="ttname"><a href="derivatives_8cc.html#a423df6189110b25bb1b2836671974b25">energy</a></div><div class="ttdeci">double(* energy)()</div><div class="ttdef"><b>Definition</b> derivatives.cc:58</div></div>
<div class="ttc" id="ahatom__energy_8cc_html_a7572433ce934df0e233caee87519ae12"><div class="ttname"><a href="hatom__energy_8cc.html#a7572433ce934df0e233caee87519ae12">psi</a></div><div class="ttdeci">double psi(const Vector&lt; double, 3 &gt; &amp;r)</div><div class="ttdef"><b>Definition</b> hatom_energy.cc:78</div></div>
<div class="ttc" id="ahatom__sf__dirac_8cc_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="hatom__sf__dirac_8cc.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">static const double v</div><div class="ttdef"><b>Definition</b> hatom_sf_dirac.cc:20</div></div>
<div class="ttc" id="ainfo_8h_html"><div class="ttname"><a href="info_8h.html">info.h</a></div><div class="ttdoc">Defines functions that give information on this version of MADNESS.</div></div>
<div class="ttc" id="alapack_8cc_html_a3579439861af6b9e1cb7409d286ad0f6"><div class="ttname"><a href="lapack_8cc.html#a3579439861af6b9e1cb7409d286ad0f6">ss1</a></div><div class="ttdeci">double ss1</div><div class="ttdef"><b>Definition</b> lapack.cc:62</div></div>
<div class="ttc" id="alapack_8cc_html_a60612d39c03186dc3f7a12b859718c6f"><div class="ttname"><a href="lapack_8cc.html#a60612d39c03186dc3f7a12b859718c6f">tt1</a></div><div class="ttdeci">double tt1</div><div class="ttdef"><b>Definition</b> lapack.cc:62</div></div>
<div class="ttc" id="amadness_2chem_2molecularbasis_8h_html"><div class="ttname"><a href="madness_2chem_2molecularbasis_8h.html">molecularbasis.h</a></div></div>
<div class="ttc" id="amadness__exception_8h_html_ae80fa540b62afc0e301296b3102ec106"><div class="ttname"><a href="madness__exception_8h.html#ae80fa540b62afc0e301296b3102ec106">MADNESS_ASSERT</a></div><div class="ttdeci">#define MADNESS_ASSERT(condition)</div><div class="ttdoc">Assert a condition that should be free of side-effects since in release builds this might be a no-op.</div><div class="ttdef"><b>Definition</b> madness_exception.h:134</div></div>
<div class="ttc" id="amolecular__optimizer_8h_html"><div class="ttname"><a href="molecular__optimizer_8h.html">molecular_optimizer.h</a></div><div class="ttdoc">optimize the geometrical structure of a molecule</div></div>
<div class="ttc" id="amolecule_8h_html"><div class="ttname"><a href="molecule_8h.html">molecule.h</a></div></div>
<div class="ttc" id="amra_8h_html"><div class="ttname"><a href="mra_8h.html">mra.h</a></div><div class="ttdoc">Main include file for MADNESS and defines Function interface.</div></div>
<div class="ttc" id="anamespacemadness_html"><div class="ttname"><a href="namespacemadness.html">madness</a></div><div class="ttdoc">Namespace for all elements and tools of MADNESS.</div><div class="ttdef"><b>Definition</b> DFParameters.h:10</div></div>
<div class="ttc" id="anamespacemadness_html_a19b289c4e20e33679e6ecbdbd9ae22af"><div class="ttname"><a href="namespacemadness.html#a19b289c4e20e33679e6ecbdbd9ae22af">madness::print_header2</a></div><div class="ttdeci">void print_header2(const std::string &amp;s)</div><div class="ttdoc">medium section heading</div><div class="ttdef"><b>Definition</b> print.cc:54</div></div>
<div class="ttc" id="anamespacemadness_html_a1ae5928a1d5da5680156d9e198da3fa0"><div class="ttname"><a href="namespacemadness.html#a1ae5928a1d5da5680156d9e198da3fa0">madness::cpu_time</a></div><div class="ttdeci">static double cpu_time()</div><div class="ttdoc">Returns the cpu time in seconds relative to an arbitrary origin.</div><div class="ttdef"><b>Definition</b> timers.h:127</div></div>
<div class="ttc" id="anamespacemadness_html_a440197c51201ff71ae78d471df968d35"><div class="ttname"><a href="namespacemadness.html#a440197c51201ff71ae78d471df968d35">madness::transform</a></div><div class="ttdeci">std::vector&lt; Function&lt; TENSOR_RESULT_TYPE(T, R), NDIM &gt; &gt; transform(World &amp;world, const std::vector&lt; Function&lt; T, NDIM &gt; &gt; &amp;v, const Tensor&lt; R &gt; &amp;c, bool fence=true)</div><div class="ttdoc">Transforms a vector of functions according to new[i] = sum[j] old[j]*c[j,i].</div><div class="ttdef"><b>Definition</b> vmra.h:707</div></div>
<div class="ttc" id="anamespacemadness_html_a8e25cfffd1a97d7e7245986fea72493c"><div class="ttname"><a href="namespacemadness.html#a8e25cfffd1a97d7e7245986fea72493c">madness::real_factory_3d</a></div><div class="ttdeci">FunctionFactory&lt; double, 3 &gt; real_factory_3d</div><div class="ttdef"><b>Definition</b> functypedefs.h:108</div></div>
<div class="ttc" id="anamespacemadness_html_a925cbfa806133b64f5cee7a7d810efeb"><div class="ttname"><a href="namespacemadness.html#a925cbfa806133b64f5cee7a7d810efeb">madness::print</a></div><div class="ttdeci">void print(const T &amp;t, const Ts &amp;... ts)</div><div class="ttdoc">Print items to std::cout (items separated by spaces) and terminate with a new line.</div><div class="ttdef"><b>Definition</b> print.h:226</div></div>
<div class="ttc" id="anamespacemadness_html_aa9b46b378a475000e5fc99f204a778dd"><div class="ttname"><a href="namespacemadness.html#aa9b46b378a475000e5fc99f204a778dd">madness::wall_time</a></div><div class="ttdeci">double wall_time()</div><div class="ttdoc">Returns the wall time in seconds relative to an arbitrary origin.</div><div class="ttdef"><b>Definition</b> timers.cc:48</div></div>
<div class="ttc" id="anamespacemadness_html_aabc223d277e0d9dd79d7c61d200d457f"><div class="ttname"><a href="namespacemadness.html#aabc223d277e0d9dd79d7c61d200d457f">madness::real_function_3d</a></div><div class="ttdeci">Function&lt; double, 3 &gt; real_function_3d</div><div class="ttdef"><b>Definition</b> functypedefs.h:80</div></div>
<div class="ttc" id="anamespacemadness_html_ab77fa10a790d9453a381fe55bbb6f287"><div class="ttname"><a href="namespacemadness.html#ab77fa10a790d9453a381fe55bbb6f287">madness::inner</a></div><div class="ttdeci">double inner(response_space &amp;a, response_space &amp;b)</div><div class="ttdef"><b>Definition</b> response_functions.h:640</div></div>
<div class="ttc" id="anamespacemadness_html_ab993d652410fcc0ae07582302d281ceb"><div class="ttname"><a href="namespacemadness.html#ab993d652410fcc0ae07582302d281ceb">madness::imag</a></div><div class="ttdeci">double imag(double x)</div><div class="ttdef"><b>Definition</b> complexfun.h:56</div></div>
<div class="ttc" id="anamespacemadness_html_ad54b4e42440e93ddb426ed9f2e7a8c0e"><div class="ttname"><a href="namespacemadness.html#ad54b4e42440e93ddb426ed9f2e7a8c0e">madness::grad</a></div><div class="ttdeci">std::vector&lt; Function&lt; T, NDIM &gt; &gt; grad(const Function&lt; T, NDIM &gt; &amp;f, bool refine=false, bool fence=true)</div><div class="ttdoc">shorthand gradient operator</div><div class="ttdef"><b>Definition</b> vmra.h:2034</div></div>
<div class="ttc" id="anamespacemadness_html_ae040c842d4ec0217aafc3183463851ae"><div class="ttname"><a href="namespacemadness.html#ae040c842d4ec0217aafc3183463851ae">madness::real</a></div><div class="ttdeci">double real(double x)</div><div class="ttdef"><b>Definition</b> complexfun.h:52</div></div>
<div class="ttc" id="anemo_8h_html"><div class="ttname"><a href="nemo_8h.html">nemo.h</a></div></div>
<div class="ttc" id="anonlinschro_8cc_html_ab725778fe3179d0229a8da4c908bdf61"><div class="ttname"><a href="nonlinschro_8cc.html#ab725778fe3179d0229a8da4c908bdf61">a</a></div><div class="ttdeci">static const double a</div><div class="ttdef"><b>Definition</b> nonlinschro.cc:118</div></div>
<div class="ttc" id="anonlinsol_8h_html"><div class="ttname"><a href="nonlinsol_8h.html">nonlinsol.h</a></div><div class="ttdoc">Implementation of Krylov-subspace nonlinear equation solver.</div></div>
<div class="ttc" id="aoperator_8h_html"><div class="ttname"><a href="operator_8h.html">operator.h</a></div><div class="ttdoc">Implements most functionality of separated operators.</div></div>
<div class="ttc" id="ark_8cc_html_a9eab80aaf4be993b3a2cfd79b55f7fb9"><div class="ttname"><a href="rk_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a></div><div class="ttdeci">static const double thresh</div><div class="ttdef"><b>Definition</b> rk.cc:45</div></div>
<div class="ttc" id="astructmadness_1_1CalculationParameters_html"><div class="ttname"><a href="structmadness_1_1CalculationParameters.html">madness::CalculationParameters</a></div><div class="ttdef"><b>Definition</b> CalculationParameters.h:51</div></div>
<div class="ttc" id="astructmadness_1_1Nemo_1_1NemoCalculationParameters_html"><div class="ttname"><a href="structmadness_1_1Nemo_1_1NemoCalculationParameters.html">madness::Nemo::NemoCalculationParameters</a></div><div class="ttdoc">class holding parameters for a nemo calculation beyond the standard dft parameters from moldft</div><div class="ttdef"><b>Definition</b> nemo.h:333</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1landau__wave__function_html"><div class="ttname"><a href="structmadness_1_1Znemo_1_1landau__wave__function.html">madness::Znemo::landau_wave_function</a></div><div class="ttdoc">following Doucot Pascier 2005</div><div class="ttdef"><b>Definition</b> znemo.h:521</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1landau__wave__function_html_a0f7707944decebdbfe8235d58d970223"><div class="ttname"><a href="structmadness_1_1Znemo_1_1landau__wave__function.html#a0f7707944decebdbfe8235d58d970223">madness::Znemo::landau_wave_function::origin</a></div><div class="ttdeci">coord_3d origin</div><div class="ttdef"><b>Definition</b> znemo.h:525</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1landau__wave__function_html_a47333d9bc07289282da68d003ee69902"><div class="ttname"><a href="structmadness_1_1Znemo_1_1landau__wave__function.html#a47333d9bc07289282da68d003ee69902">madness::Znemo::landau_wave_function::l</a></div><div class="ttdeci">double l</div><div class="ttdoc">radius Eq. (29)</div><div class="ttdef"><b>Definition</b> znemo.h:524</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1landau__wave__function_html_a5e8e8674407c9709dd61fa0a4741bb8b"><div class="ttname"><a href="structmadness_1_1Znemo_1_1landau__wave__function.html#a5e8e8674407c9709dd61fa0a4741bb8b">madness::Znemo::landau_wave_function::operator()</a></div><div class="ttdeci">double_complex operator()(const coord_3d &amp;xyz1) const</div><div class="ttdoc">following Eq. (43)</div><div class="ttdef"><b>Definition</b> znemo.h:536</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1landau__wave__function_html_aa513edffcc695b47d344f24efd693c98"><div class="ttname"><a href="structmadness_1_1Znemo_1_1landau__wave__function.html#aa513edffcc695b47d344f24efd693c98">madness::Znemo::landau_wave_function::m</a></div><div class="ttdeci">int m</div><div class="ttdef"><b>Definition</b> znemo.h:523</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1landau__wave__function_html_ad739ca0153337d91acbea3943636e99a"><div class="ttname"><a href="structmadness_1_1Znemo_1_1landau__wave__function.html#ad739ca0153337d91acbea3943636e99a">madness::Znemo::landau_wave_function::landau_wave_function</a></div><div class="ttdeci">landau_wave_function(const int m, const double B, const coord_3d &amp;origin={0.0, 0.0, 0.0})</div><div class="ttdef"><b>Definition</b> znemo.h:527</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1p__orbital_html"><div class="ttname"><a href="structmadness_1_1Znemo_1_1p__orbital.html">madness::Znemo::p_orbital</a></div><div class="ttdef"><b>Definition</b> znemo.h:492</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1p__orbital_html_a0b511f0beae2e7da83d41c7405c3f968"><div class="ttname"><a href="structmadness_1_1Znemo_1_1p__orbital.html#a0b511f0beae2e7da83d41c7405c3f968">madness::Znemo::p_orbital::exponent</a></div><div class="ttdeci">double exponent</div><div class="ttdef"><b>Definition</b> znemo.h:495</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1p__orbital_html_a624bdac5c7845297e26eab06e07f6e58"><div class="ttname"><a href="structmadness_1_1Znemo_1_1p__orbital.html#a624bdac5c7845297e26eab06e07f6e58">madness::Znemo::p_orbital::p_orbital</a></div><div class="ttdeci">p_orbital(const long &amp;mm, const double &amp;expo, const coord_3d &amp;o)</div><div class="ttdef"><b>Definition</b> znemo.h:497</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1p__orbital_html_a676434d07064bd4cbfb7415e5db2c16e"><div class="ttname"><a href="structmadness_1_1Znemo_1_1p__orbital.html#a676434d07064bd4cbfb7415e5db2c16e">madness::Znemo::p_orbital::m</a></div><div class="ttdeci">long m</div><div class="ttdef"><b>Definition</b> znemo.h:494</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1p__orbital_html_a7d8097c3bde5e829965982afc393f924"><div class="ttname"><a href="structmadness_1_1Znemo_1_1p__orbital.html#a7d8097c3bde5e829965982afc393f924">madness::Znemo::p_orbital::operator()</a></div><div class="ttdeci">double_complex operator()(const coord_3d &amp;xyz1) const</div><div class="ttdef"><b>Definition</b> znemo.h:503</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1p__orbital_html_ad9131acef5fa236edb8e506de5e7f3ec"><div class="ttname"><a href="structmadness_1_1Znemo_1_1p__orbital.html#ad9131acef5fa236edb8e506de5e7f3ec">madness::Znemo::p_orbital::origin</a></div><div class="ttdeci">coord_3d origin</div><div class="ttdef"><b>Definition</b> znemo.h:496</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html">madness::Znemo::potentials</a></div><div class="ttdef"><b>Definition</b> znemo.h:113</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_a0dfea63b113ad7f8de94f06c189f3dd9"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#a0dfea63b113ad7f8de94f06c189f3dd9">madness::Znemo::potentials::potentials</a></div><div class="ttdeci">potentials(World &amp;world, const std::size_t nmo)</div><div class="ttdef"><b>Definition</b> znemo.h:114</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_a159928fc9acc182736f02623518be6f0"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#a159928fc9acc182736f02623518be6f0">madness::Znemo::potentials::lz_mo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; lz_mo</div><div class="ttdef"><b>Definition</b> znemo.h:139</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_a2bb76a6eef11d54d60bd6f6ee4264d87"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#a2bb76a6eef11d54d60bd6f6ee4264d87">madness::Znemo::potentials::diamagnetic_mo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; diamagnetic_mo</div><div class="ttdef"><b>Definition</b> znemo.h:138</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_a4d71daabe33626fe903f9d592b2ec48b"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#a4d71daabe33626fe903f9d592b2ec48b">madness::Znemo::potentials::lz_commutator</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; lz_commutator</div><div class="ttdef"><b>Definition</b> znemo.h:143</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_a5ba10496fef897ab77c9b3040b1dde8a"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#a5ba10496fef897ab77c9b3040b1dde8a">madness::Znemo::potentials::transform</a></div><div class="ttdeci">void transform(const Tensor&lt; double_complex &gt; &amp;U)</div><div class="ttdef"><b>Definition</b> znemo.h:125</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_a891a859813d48fd07e30a91871ffb275"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#a891a859813d48fd07e30a91871ffb275">madness::Znemo::potentials::zeeman_R_comm</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; zeeman_R_comm</div><div class="ttdef"><b>Definition</b> znemo.h:144</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_aa0d26284e07afd3375019b07e41d59b5"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#aa0d26284e07afd3375019b07e41d59b5">madness::Znemo::potentials::spin_zeeman_mo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; spin_zeeman_mo</div><div class="ttdef"><b>Definition</b> znemo.h:142</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_adc4282b48753d168c72d5afd826325a8"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#adc4282b48753d168c72d5afd826325a8">madness::Znemo::potentials::J_mo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; J_mo</div><div class="ttdef"><b>Definition</b> znemo.h:140</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_afa8f6e9c5ee1c351eb1c612ee1e755e3"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#afa8f6e9c5ee1c351eb1c612ee1e755e3">madness::Znemo::potentials::vnuc_mo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; vnuc_mo</div><div class="ttdef"><b>Definition</b> znemo.h:137</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1potentials_html_aff940e4fd605b40ca1e6df6566e624a6"><div class="ttname"><a href="structmadness_1_1Znemo_1_1potentials.html#aff940e4fd605b40ca1e6df6566e624a6">madness::Znemo::potentials::K_mo</a></div><div class="ttdeci">std::vector&lt; complex_function_3d &gt; K_mo</div><div class="ttdef"><b>Definition</b> znemo.h:141</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1s__orbital_html"><div class="ttname"><a href="structmadness_1_1Znemo_1_1s__orbital.html">madness::Znemo::s_orbital</a></div><div class="ttdef"><b>Definition</b> znemo.h:475</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1s__orbital_html_a17936530b038777b846169966b1bf5ed"><div class="ttname"><a href="structmadness_1_1Znemo_1_1s__orbital.html#a17936530b038777b846169966b1bf5ed">madness::Znemo::s_orbital::origin</a></div><div class="ttdeci">coord_3d origin</div><div class="ttdef"><b>Definition</b> znemo.h:478</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1s__orbital_html_a2ae6ee7f468c98032cb62a521ac692ff"><div class="ttname"><a href="structmadness_1_1Znemo_1_1s__orbital.html#a2ae6ee7f468c98032cb62a521ac692ff">madness::Znemo::s_orbital::s_orbital</a></div><div class="ttdeci">s_orbital(const double &amp;expo, const coord_3d &amp;o)</div><div class="ttdef"><b>Definition</b> znemo.h:479</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1s__orbital_html_a9fa9325d06501eb81bc9382527c57083"><div class="ttname"><a href="structmadness_1_1Znemo_1_1s__orbital.html#a9fa9325d06501eb81bc9382527c57083">madness::Znemo::s_orbital::exponent</a></div><div class="ttdeci">double exponent</div><div class="ttdef"><b>Definition</b> znemo.h:477</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1s__orbital_html_aadd23c028c9e5616327999ff80e60d57"><div class="ttname"><a href="structmadness_1_1Znemo_1_1s__orbital.html#aadd23c028c9e5616327999ff80e60d57">madness::Znemo::s_orbital::operator()</a></div><div class="ttdeci">double_complex operator()(const coord_3d &amp;xyz1) const</div><div class="ttdef"><b>Definition</b> znemo.h:484</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html">madness::Znemo::timer</a></div><div class="ttdef"><b>Definition</b> znemo.h:147</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_a06f6d9a8bdfa9131af9bd6f3cc2c78f5"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#a06f6d9a8bdfa9131af9bd6f3cc2c78f5">madness::Znemo::timer::tag</a></div><div class="ttdeci">void tag(const std::string msg)</div><div class="ttdef"><b>Definition</b> znemo.h:158</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_a11c33c19b37e9b536c212933dbebc6ea"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#a11c33c19b37e9b536c212933dbebc6ea">madness::Znemo::timer::do_print</a></div><div class="ttdeci">bool do_print</div><div class="ttdef"><b>Definition</b> znemo.h:150</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_a4b26baf0f375694c26ecbba4bbfbaa71"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#a4b26baf0f375694c26ecbba4bbfbaa71">madness::Znemo::timer::end</a></div><div class="ttdeci">void end(const std::string msg)</div><div class="ttdef"><b>Definition</b> znemo.h:167</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_a5ffd0808582c8a2ee83c16f8b17d893c"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#a5ffd0808582c8a2ee83c16f8b17d893c">madness::Znemo::timer::world</a></div><div class="ttdeci">World &amp; world</div><div class="ttdef"><b>Definition</b> znemo.h:148</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_a853255589edbc3a8b5f63624940cb7f8"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#a853255589edbc3a8b5f63624940cb7f8">madness::Znemo::timer::sss</a></div><div class="ttdeci">double sss</div><div class="ttdef"><b>Definition</b> znemo.h:149</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_a9a440782d56c05ab04bc2c45db9c05a4"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#a9a440782d56c05ab04bc2c45db9c05a4">madness::Znemo::timer::timer</a></div><div class="ttdeci">timer(World &amp;world, bool do_print=true)</div><div class="ttdef"><b>Definition</b> znemo.h:152</div></div>
<div class="ttc" id="astructmadness_1_1Znemo_1_1timer_html_ab3ca5b3f99d1dc69f5a71a4f18f91904"><div class="ttname"><a href="structmadness_1_1Znemo_1_1timer.html#ab3ca5b3f99d1dc69f5a71a4f18f91904">madness::Znemo::timer::ttt</a></div><div class="ttdeci">double ttt</div><div class="ttdef"><b>Definition</b> znemo.h:149</div></div>
<div class="ttc" id="astructmadness_1_1commandlineparser_html"><div class="ttname"><a href="structmadness_1_1commandlineparser.html">madness::commandlineparser</a></div><div class="ttdoc">very simple command line parser</div><div class="ttdef"><b>Definition</b> commandlineparser.h:15</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html"><div class="ttname"><a href="structmadness_1_1printleveler.html">madness::printleveler</a></div><div class="ttdef"><b>Definition</b> znemo.h:31</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a33efe02a8e4dfe3ca0d06d0b598c78fc"><div class="ttname"><a href="structmadness_1_1printleveler.html#a33efe02a8e4dfe3ca0d06d0b598c78fc">madness::printleveler::print_timings_</a></div><div class="ttdeci">bool print_timings_</div><div class="ttdef"><b>Definition</b> znemo.h:35</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a4c9dff6a6fd34ad5f31fda2d14750118"><div class="ttname"><a href="structmadness_1_1printleveler.html#a4c9dff6a6fd34ad5f31fda2d14750118">madness::printleveler::print_convergence_</a></div><div class="ttdeci">bool print_convergence_</div><div class="ttdef"><b>Definition</b> znemo.h:36</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a4e7efe029a814d3bd4afb54a5d424d96"><div class="ttname"><a href="structmadness_1_1printleveler.html#a4e7efe029a814d3bd4afb54a5d424d96">madness::printleveler::print_setup</a></div><div class="ttdeci">bool print_setup() const</div><div class="ttdef"><b>Definition</b> znemo.h:47</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a64fe54adb15f6df53c93d2f95f27e077"><div class="ttname"><a href="structmadness_1_1printleveler.html#a64fe54adb15f6df53c93d2f95f27e077">madness::printleveler::print_energies_</a></div><div class="ttdeci">bool print_energies_</div><div class="ttdef"><b>Definition</b> znemo.h:34</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a6685bd8378fe43d170b2ea225a4196f8"><div class="ttname"><a href="structmadness_1_1printleveler.html#a6685bd8378fe43d170b2ea225a4196f8">madness::printleveler::print_convergence</a></div><div class="ttdeci">bool print_convergence() const</div><div class="ttdef"><b>Definition</b> znemo.h:50</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a79847d286914f8461de38de37a917230"><div class="ttname"><a href="structmadness_1_1printleveler.html#a79847d286914f8461de38de37a917230">madness::printleveler::print_energies</a></div><div class="ttdeci">bool print_energies() const</div><div class="ttdef"><b>Definition</b> znemo.h:48</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a828bd771f863023985660935c103c3fa"><div class="ttname"><a href="structmadness_1_1printleveler.html#a828bd771f863023985660935c103c3fa">madness::printleveler::print_debug</a></div><div class="ttdeci">bool print_debug() const</div><div class="ttdef"><b>Definition</b> znemo.h:51</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_a8afd355e11ea95c2977f1e18cb505718"><div class="ttname"><a href="structmadness_1_1printleveler.html#a8afd355e11ea95c2977f1e18cb505718">madness::printleveler::print_nothing_</a></div><div class="ttdeci">bool print_nothing_</div><div class="ttdef"><b>Definition</b> znemo.h:32</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_aa8d87cdf65980bbcb56ca429f2e033b0"><div class="ttname"><a href="structmadness_1_1printleveler.html#aa8d87cdf65980bbcb56ca429f2e033b0">madness::printleveler::printleveler</a></div><div class="ttdeci">printleveler(int printlevel)</div><div class="ttdef"><b>Definition</b> znemo.h:39</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_adb014d08baa8b3b19a1e2e5e88acd265"><div class="ttname"><a href="structmadness_1_1printleveler.html#adb014d08baa8b3b19a1e2e5e88acd265">madness::printleveler::print_debug_information_</a></div><div class="ttdeci">bool print_debug_information_</div><div class="ttdef"><b>Definition</b> znemo.h:37</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_af5bb77f4c86d949d55a0ea6276817bab"><div class="ttname"><a href="structmadness_1_1printleveler.html#af5bb77f4c86d949d55a0ea6276817bab">madness::printleveler::print_timings</a></div><div class="ttdeci">bool print_timings() const</div><div class="ttdef"><b>Definition</b> znemo.h:49</div></div>
<div class="ttc" id="astructmadness_1_1printleveler_html_af8bc31d2647f543b97b37c34c0d68534"><div class="ttname"><a href="structmadness_1_1printleveler.html#af8bc31d2647f543b97b37c34c0d68534">madness::printleveler::print_setup_</a></div><div class="ttdeci">bool print_setup_</div><div class="ttdef"><b>Definition</b> znemo.h:33</div></div>
<div class="ttc" id="astructmadness_1_1vector__function__allocator_html"><div class="ttname"><a href="structmadness_1_1vector__function__allocator.html">madness::vector_function_allocator</a></div><div class="ttdef"><b>Definition</b> nonlinsol.h:174</div></div>
<div class="ttc" id="avmra_8h_html"><div class="ttname"><a href="vmra_8h.html">vmra.h</a></div><div class="ttdoc">Defines operations on vectors of Functions.</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 28 2025 18:18:36 for MADNESS by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
