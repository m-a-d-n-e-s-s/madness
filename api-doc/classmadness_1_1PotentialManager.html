<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MADNESS: madness::PotentialManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MADNESS<span id="projectnumber">&#160;0.10.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemadness.html">madness</a></li><li class="navelem"><a class="el" href="classmadness_1_1PotentialManager.html">PotentialManager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classmadness_1_1PotentialManager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">madness::PotentialManager Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Manages molecular potentials and core projections for quantum chemistry calculations.  
 <a href="classmadness_1_1PotentialManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="potentialmanager_8h_source.html">potentialmanager.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for madness::PotentialManager:</div>
<div class="dyncontent">
<div class="center"><img src="classmadness_1_1PotentialManager__coll__graph.png" border="0" usemap="#amadness_1_1PotentialManager_coll__map" alt="Collaboration graph"/></div>
<map name="amadness_1_1PotentialManager_coll__map" id="amadness_1_1PotentialManager_coll__map">
<area shape="rect" title="Manages molecular potentials and core projections for quantum chemistry calculations." alt="" coords="1044,94,1248,119"/>
<area shape="rect" href="classmadness_1_1Molecule.html" title=" " alt="" coords="809,94,957,119"/>
<area shape="poly" title=" " alt="" coords="971,104,1044,104,1044,109,971,109"/>
<area shape="rect" href="classmadness_1_1CorePotentialManager.html" title=" " alt="" coords="443,69,677,94"/>
<area shape="poly" title=" " alt="" coords="691,89,808,98,808,104,691,94"/>
<area shape="rect" title=" " alt="" coords="119,7,178,33"/>
<area shape="poly" title=" " alt="" coords="191,15,316,9,419,9,548,7,605,8,678,13,796,29,912,50,1095,91,1094,97,911,56,795,35,677,19,605,13,548,13,419,15,316,15,192,20"/>
<area shape="poly" title=" " alt="" coords="192,19,401,29,538,40,678,53,730,60,782,71,848,91,847,96,781,76,729,65,677,59,538,45,400,35,192,24"/>
<area shape="poly" title=" " alt="" coords="192,32,250,50,316,65,380,73,443,78,442,83,379,79,316,71,249,55,190,37"/>
<area shape="rect" href="classmadness_1_1Tensor.html" title=" " alt="" coords="457,118,663,143"/>
<area shape="poly" title=" " alt="" coords="677,130,781,124,827,117,828,122,782,129,677,135"/>
<area shape="rect" href="classmadness_1_1BaseTensor.html" title="The base class for tensors defines generic capabilities." alt="" coords="67,118,230,143"/>
<area shape="poly" title=" " alt="" coords="244,128,457,128,457,133,244,133"/>
<area shape="rect" href="structmadness_1_1Molecule_1_1GeometryParameters.html" title=" " alt="" coords="479,168,641,208"/>
<area shape="poly" title=" " alt="" coords="654,176,717,165,781,149,821,134,857,117,859,122,823,139,782,155,718,170,655,181"/>
<area shape="rect" href="classmadness_1_1QCCalculationParametersBase.html" title="class for holding the parameters for calculation" alt="" coords="5,175,292,201"/>
<area shape="poly" title=" " alt="" coords="306,185,479,185,479,191,306,191"/>
<area shape="rect" href="classmadness_1_1Function.html" title=" " alt="" coords="805,232,960,272"/>
<area shape="poly" title=" " alt="" coords="931,223,1121,117,1123,122,933,228"/>
<area shape="rect" href="classmadness_1_1archive_1_1ParallelSerializableObject.html" title="Objects that implement their own parallel archive interface should derive from this class." alt="" coords="463,232,657,272"/>
<area shape="poly" title=" " alt="" coords="670,249,805,249,805,255,670,255"/>
<area shape="rect" title=" " alt="" coords="531,297,589,322"/>
<area shape="poly" title=" " alt="" coords="602,300,781,269,804,265,805,270,782,275,603,305"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7951a5c51faa671fa6f43a3b1b194378" id="r_a7951a5c51faa671fa6f43a3b1b194378"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#a7951a5c51faa671fa6f43a3b1b194378">PotentialManager</a> (const <a class="el" href="classmadness_1_1Molecule.html">Molecule</a> &amp;<a class="el" href="classmadness_1_1PotentialManager.html#a4f050c215667aa0793450c6688437bfb">molecule</a>, const std::string &amp;<a class="el" href="classmadness_1_1PotentialManager.html#aa6784f7419d103107af6f4a66988f374">core_type</a>)</td></tr>
<tr class="separator:a7951a5c51faa671fa6f43a3b1b194378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad573f584de81a0d73a82dca0a69a1e" id="r_a3ad573f584de81a0d73a82dca0a69a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#a3ad573f584de81a0d73a82dca0a69a1e">apply_nonlocal_potential</a> (<a class="el" href="classmadness_1_1World.html">World</a> &amp;world, const <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> &amp;amo, <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> Vpsi)</td></tr>
<tr class="separator:a3ad573f584de81a0d73a82dca0a69a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad858ccc0c8cfd173e1ee0e58f6f8f051" id="r_ad858ccc0c8cfd173e1ee0e58f6f8f051"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#ad858ccc0c8cfd173e1ee0e58f6f8f051">core_projection</a> (<a class="el" href="classmadness_1_1World.html">World</a> &amp;world, const <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> &amp;<a class="el" href="hatom__energy_8cc.html#a7572433ce934df0e233caee87519ae12">psi</a>, const bool include_Bc=true)</td></tr>
<tr class="memdesc:ad858ccc0c8cfd173e1ee0e58f6f8f051"><td class="mdescLeft">&#160;</td><td class="mdescRight">Projects the input wavefunctions onto the atomic core orbitals.  <br /></td></tr>
<tr class="separator:ad858ccc0c8cfd173e1ee0e58f6f8f051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed904646fcb070da016891f4167b309" id="r_aeed904646fcb070da016891f4167b309"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#aeed904646fcb070da016891f4167b309">core_projector_derivative</a> (<a class="el" href="classmadness_1_1World.html">World</a> &amp;world, const <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> &amp;mo, const <a class="el" href="namespacemadness.html#aec60a184c8b61af2fa44bb7e6ffa5aac">real_tensor</a> &amp;occ, int atom, int <a class="el" href="testpdiff_8cc.html#a4e8f5fcd5d7ed8b5d6f1f232be70dc11">axis</a>)</td></tr>
<tr class="memdesc:aeed904646fcb070da016891f4167b309"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the derivative of the core projector operator with respect to a given axis for a specified atom.  <br /></td></tr>
<tr class="separator:aeed904646fcb070da016891f4167b309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6784f7419d103107af6f4a66988f374" id="r_aa6784f7419d103107af6f4a66988f374"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#aa6784f7419d103107af6f4a66988f374">core_type</a> () const</td></tr>
<tr class="separator:aa6784f7419d103107af6f4a66988f374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2eeba40ab024d59f0c90a5e33fa1b91" id="r_af2eeba40ab024d59f0c90a5e33fa1b91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#af2eeba40ab024d59f0c90a5e33fa1b91">make_nuclear_potential</a> (<a class="el" href="classmadness_1_1World.html">World</a> &amp;world)</td></tr>
<tr class="separator:af2eeba40ab024d59f0c90a5e33fa1b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f050c215667aa0793450c6688437bfb" id="r_a4f050c215667aa0793450c6688437bfb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classmadness_1_1Molecule.html">Molecule</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#a4f050c215667aa0793450c6688437bfb">molecule</a> () const</td></tr>
<tr class="separator:a4f050c215667aa0793450c6688437bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a558464b62b16d1021bbea5840db3f858" id="r_a558464b62b16d1021bbea5840db3f858"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacemadness.html#aabc223d277e0d9dd79d7c61d200d457f">real_function_3d</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#a558464b62b16d1021bbea5840db3f858">vnuclear</a> ()</td></tr>
<tr class="separator:a558464b62b16d1021bbea5840db3f858"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afc0488f91720ed88a7f12568f477124a" id="r_afc0488f91720ed88a7f12568f477124a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#afc0488f91720ed88a7f12568f477124a">core_type_</a></td></tr>
<tr class="separator:afc0488f91720ed88a7f12568f477124a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14dda2b5a85a02ff5e79fc54e8d62717" id="r_a14dda2b5a85a02ff5e79fc54e8d62717"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmadness_1_1Molecule.html">Molecule</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#a14dda2b5a85a02ff5e79fc54e8d62717">mol</a></td></tr>
<tr class="separator:a14dda2b5a85a02ff5e79fc54e8d62717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad710cccbf3202043fbcb6a79282bf9c0" id="r_ad710cccbf3202043fbcb6a79282bf9c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemadness.html#aabc223d277e0d9dd79d7c61d200d457f">real_function_3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1PotentialManager.html#ad710cccbf3202043fbcb6a79282bf9c0">vnuc</a></td></tr>
<tr class="separator:ad710cccbf3202043fbcb6a79282bf9c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages molecular potentials and core projections for quantum chemistry calculations. </p>
<p>This class encapsulates the management of nuclear and core potentials for a given molecule, including the construction of nuclear potentials, application of nonlocal core projectors, and calculation of core projector derivatives. It provides interfaces to access the molecule, core type, and nuclear potential, as well as to perform core projections and apply nonlocal potentials. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7951a5c51faa671fa6f43a3b1b194378" name="a7951a5c51faa671fa6f43a3b1b194378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7951a5c51faa671fa6f43a3b1b194378">&#9670;&#160;</a></span>PotentialManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">madness::PotentialManager::PotentialManager </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmadness_1_1Molecule.html">Molecule</a> &amp;&#160;</td>
          <td class="paramname"><em>molecule</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>core_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3ad573f584de81a0d73a82dca0a69a1e" name="a3ad573f584de81a0d73a82dca0a69a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad573f584de81a0d73a82dca0a69a1e">&#9670;&#160;</a></span>apply_nonlocal_potential()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::PotentialManager::apply_nonlocal_potential </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmadness_1_1World.html">World</a> &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>amo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a>&#160;</td>
          <td class="paramname"><em>Vpsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="namespacemadness.html#afcb1ed1a3e6b3b14b0e5624b5b3a0653">madness::gaxpy()</a>.</p>

</div>
</div>
<a id="ad858ccc0c8cfd173e1ee0e58f6f8f051" name="ad858ccc0c8cfd173e1ee0e58f6f8f051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad858ccc0c8cfd173e1ee0e58f6f8f051">&#9670;&#160;</a></span>core_projection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> madness::PotentialManager::core_projection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmadness_1_1World.html">World</a> &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>include_Bc</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Projects the input wavefunctions onto the atomic core orbitals. </p>
<p>This function computes the projection of the given set of wavefunctions (<code>psi</code>) onto the core orbitals of each atom in the molecule. The projection is performed for each atom and each of its core orbitals, accumulating the result in the returned vector of functions. Optionally, the projection can include the core boundary condition factor (<code>Bc</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">world</td><td>The MADNESS <a class="el" href="classmadness_1_1World.html" title="A parallel world class.">World</a> object for parallel execution and data management. </td></tr>
    <tr><td class="paramname">psi</td><td>The input vector of real 3<a class="el" href="structD.html">D</a> functions (wavefunctions) to be projected. </td></tr>
    <tr><td class="paramname">include_Bc</td><td>If true, includes the core boundary condition factor in the projection (default: true). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classA.html">A</a> vector of real 3<a class="el" href="structD.html">D</a> functions representing the projection of <code>psi</code> onto the core orbitals. </dd></dl>

<p class="reference">References <a class="el" href="classmadness_1_1Atom.html#a309e72a07bd1ceb2a35f156fedf1ba56">madness::Atom::atomic_number</a>, <a class="el" href="relops_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, <a class="el" href="classmadness_1_1WorldGopInterface.html#a38629ed5c3a209def2a35ac8eb8ce336">madness::WorldGopInterface::fence()</a>, <a class="el" href="classmadness_1_1Molecule.html#a4450505faae83119084055d3bf598f88">madness::Molecule::get_atom()</a>, <a class="el" href="classmadness_1_1Molecule.html#a1b849988f24edd5448b4a6507ad3a05b">madness::Molecule::get_core_bc()</a>, <a class="el" href="classmadness_1_1Molecule.html#ab55d6adce9d9abf395e4b0caa5f4d4f3">madness::Molecule::get_core_l()</a>, <a class="el" href="classmadness_1_1World.html#ac38c53af9794c1b1c7c6e00c7399705f">madness::World::gop</a>, <a class="el" href="fcwf_8cc.html#ac9c1d98ab6415b5d03f9ffc503a497f1">inner()</a>, <a class="el" href="relops_8cc.html#a9990e99e87d163c58817550b21d35a83">m</a>, <a class="el" href="classmadness_1_1Molecule.html#ad0bad401a37826f01151655c161be5b7">madness::Molecule::n_core_orb()</a>, <a class="el" href="classmadness_1_1Molecule.html#a8a95eaff055c23580e27bdc864bfc0cb">madness::Molecule::natom()</a>, <a class="el" href="mcpfit_8cc.html#ad5c820bf5b88d465aa91f87591658f03">print()</a>, <a class="el" href="hatom__energy_8cc.html#a7572433ce934df0e233caee87519ae12">psi()</a>, <a class="el" href="classmadness_1_1World.html#a6cb4bff7804dc04970620fa61acd7876">madness::World::rank()</a>, and <a class="el" href="classmadness_1_1Function.html#a1b4d69841a957d0cbd25948f70d81a2d">madness::Function&lt; T, NDIM &gt;::scale()</a>.</p>

</div>
</div>
<a id="aeed904646fcb070da016891f4167b309" name="aeed904646fcb070da016891f4167b309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed904646fcb070da016891f4167b309">&#9670;&#160;</a></span>core_projector_derivative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::PotentialManager::core_projector_derivative </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmadness_1_1World.html">World</a> &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#a6df33082686a2b95565459297f49fd86">vector_real_function_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>mo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#aec60a184c8b61af2fa44bb7e6ffa5aac">real_tensor</a> &amp;&#160;</td>
          <td class="paramname"><em>occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the derivative of the core projector operator with respect to a given axis for a specified atom. </p>
<p>This function projects the core orbitals and their derivatives onto the molecular orbitals, then evaluates the sum:  </p><p class="formulaDsp">
<picture><source srcset="form_331_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
\sum_i \mathrm{occ}_i \langle \psi_i | \left( \sum_c B_c \frac{d}{dx} | \mathrm{core} \rangle \langle \mathrm{core} | \right) | \psi_i \rangle
\]" src="form_331.png"/></picture>
</p>
<p> where <picture><source srcset="form_332_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \psi_i $" src="form_332.png"/></picture> are molecular orbitals, <picture><source srcset="form_333_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathrm{occ}_i $" src="form_333.png"/></picture> are their occupations, and the sum over <picture><source srcset="form_191_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ c $" src="form_191.png"/></picture> runs over the core orbitals of the specified atom.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">world</td><td>The MADNESS <a class="el" href="classmadness_1_1World.html" title="A parallel world class.">World</a> object for parallel computation. </td></tr>
    <tr><td class="paramname">mo</td><td>The vector of molecular orbitals as real-valued 3<a class="el" href="structD.html">D</a> functions. </td></tr>
    <tr><td class="paramname">occ</td><td>The occupation numbers for each molecular orbital. </td></tr>
    <tr><td class="paramname">atom</td><td>The index of the atom for which the core projector derivative is computed. </td></tr>
    <tr><td class="paramname">axis</td><td>The spatial axis (0=x, 1=y, 2=z) along which the derivative is taken. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed derivative value as a double. </dd></dl>

<p class="reference">References <a class="el" href="classmadness_1_1Atom.html#a309e72a07bd1ceb2a35f156fedf1ba56">madness::Atom::atomic_number</a>, <a class="el" href="testpdiff_8cc.html#a4e8f5fcd5d7ed8b5d6f1f232be70dc11">axis</a>, <a class="el" href="relops_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, <a class="el" href="interp3_8cc.html#aba60904b56a5dce7e291d2f7d62e9782">func()</a>, <a class="el" href="classmadness_1_1Molecule.html#a4450505faae83119084055d3bf598f88">madness::Molecule::get_atom()</a>, <a class="el" href="classmadness_1_1Molecule.html#a1b849988f24edd5448b4a6507ad3a05b">madness::Molecule::get_core_bc()</a>, <a class="el" href="classmadness_1_1Molecule.html#ab55d6adce9d9abf395e4b0caa5f4d4f3">madness::Molecule::get_core_l()</a>, <a class="el" href="fcwf_8cc.html#ac9c1d98ab6415b5d03f9ffc503a497f1">inner()</a>, <a class="el" href="relops_8cc.html#a9990e99e87d163c58817550b21d35a83">m</a>, and <a class="el" href="classmadness_1_1Molecule.html#ad0bad401a37826f01151655c161be5b7">madness::Molecule::n_core_orb()</a>.</p>

</div>
</div>
<a id="aa6784f7419d103107af6f4a66988f374" name="aa6784f7419d103107af6f4a66988f374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6784f7419d103107af6f4a66988f374">&#9670;&#160;</a></span>core_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string &amp; madness::PotentialManager::core_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af2eeba40ab024d59f0c90a5e33fa1b91" name="af2eeba40ab024d59f0c90a5e33fa1b91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2eeba40ab024d59f0c90a5e33fa1b91">&#9670;&#160;</a></span>make_nuclear_potential()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::PotentialManager::make_nuclear_potential </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmadness_1_1World.html">World</a> &amp;&#160;</td>
          <td class="paramname"><em>world</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="classmadness_1_1Function.html#a6ebecb0aa9d78bcae9955f396d63943d">madness::Function&lt; T, NDIM &gt;::reconstruct()</a>, <a class="el" href="classmadness_1_1Function.html#a5ed567cff8c2ee65ceee838757d289da">madness::Function&lt; T, NDIM &gt;::set_thresh()</a>, <a class="el" href="classmadness_1_1FunctionDefaults.html#a6be050e66d1794a0ca05e5f53b7d598e">madness::FunctionDefaults&lt; NDIM &gt;::thresh</a>, <a class="el" href="classmadness_1_1Function.html#a57edf0cd8d061fecb382f41f5d81d736">madness::Function&lt; T, NDIM &gt;::thresh()</a>, <a class="el" href="classmadness_1_1Function.html#a67a39bfe0d0680ba6ae2366c28faea66">madness::Function&lt; T, NDIM &gt;::truncate()</a>, and <a class="el" href="testspectralprop_8cc.html#a81057ac4a5e54162d34a7b5294357d41">vnuc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1SCF.html#a2175d08dbdeea2dfc68c3c0727533b3f">madness::SCF::make_nuclear_potential()</a>.</p>

</div>
</div>
<a id="a4f050c215667aa0793450c6688437bfb" name="a4f050c215667aa0793450c6688437bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f050c215667aa0793450c6688437bfb">&#9670;&#160;</a></span>molecule()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classmadness_1_1Molecule.html">Molecule</a> &amp; madness::PotentialManager::molecule </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a558464b62b16d1021bbea5840db3f858" name="a558464b62b16d1021bbea5840db3f858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a558464b62b16d1021bbea5840db3f858">&#9670;&#160;</a></span>vnuclear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacemadness.html#aabc223d277e0d9dd79d7c61d200d457f">real_function_3d</a> &amp; madness::PotentialManager::vnuclear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="testspectralprop_8cc.html#a81057ac4a5e54162d34a7b5294357d41">vnuc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="afc0488f91720ed88a7f12568f477124a" name="afc0488f91720ed88a7f12568f477124a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc0488f91720ed88a7f12568f477124a">&#9670;&#160;</a></span>core_type_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string madness::PotentialManager::core_type_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a14dda2b5a85a02ff5e79fc54e8d62717" name="a14dda2b5a85a02ff5e79fc54e8d62717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14dda2b5a85a02ff5e79fc54e8d62717">&#9670;&#160;</a></span>mol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmadness_1_1Molecule.html">Molecule</a> madness::PotentialManager::mol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad710cccbf3202043fbcb6a79282bf9c0" name="ad710cccbf3202043fbcb6a79282bf9c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad710cccbf3202043fbcb6a79282bf9c0">&#9670;&#160;</a></span>vnuc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemadness.html#aabc223d277e0d9dd79d7c61d200d457f">real_function_3d</a> madness::PotentialManager::vnuc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="potentialmanager_8h_source.html">potentialmanager.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 28 2026 13:36:11 for MADNESS by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
