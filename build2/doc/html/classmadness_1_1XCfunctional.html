<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MADNESS: madness::XCfunctional Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MADNESS
   &#160;<span id="projectnumber">0.10.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemadness.html">madness</a></li><li class="navelem"><a class="el" href="classmadness_1_1XCfunctional.html">XCfunctional</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classmadness_1_1XCfunctional-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">madness::XCfunctional Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Simplified interface to XC functionals.  
 <a href="classmadness_1_1XCfunctional.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="xcfunctional_8h_source.html">xcfunctional.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a41609549f1de62ee9474b202700def62"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62">xc_arg</a> { <br />
&#160;&#160;<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62af0355a05ca6bf50e8cbd418bde146684">enum_rhoa</a> =0, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62aad32f8c17f5996758507ffc75af788e3">enum_rhob</a> =1, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a8b8087b835d89fe8576be80e46af76d3">enum_rho_pt</a> =2, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a9d0351d5563ec33c22a09d60b6de8ae6">enum_saa</a> =10, 
<br />
&#160;&#160;<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62ac7144a1b110a41ec309d68ca8c817a55">enum_sab</a> =11, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a9cf1c0cde82dad883075aafa8128ed80">enum_sbb</a> =12, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a5ac32ec5c2e74e7a955aee29dfd991ca">enum_sigtot</a> =13, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62ad5a8723bd6fa4d7b066ee01836125621">enum_sigma_pta_div_rho</a> =14, 
<br />
&#160;&#160;<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62aea47e1a7036b0aeacd372e0809b20f77">enum_sigma_ptb_div_rho</a> =15, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62ac4f018c81b3a3302f74992a506c8a575">enum_zetaa_x</a> =16, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a3ab0ae8366fa0e39cfaa562283b36f17">enum_zetaa_y</a> =17, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62ad0f6e375f222655f1244c975ebfce032">enum_zetaa_z</a> =18, 
<br />
&#160;&#160;<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a5c3d3af1f4d01759807227db0a04ff1a">enum_zetab_x</a> =19, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a17af1c3d07e71f809614d198f3286247">enum_zetab_y</a> =20, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a1f70042480cf92a20e4a5d15c487735f">enum_zetab_z</a> =21, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a8f04cefec4fa0851a2244de4975838df">enum_chi_aa</a> =22, 
<br />
&#160;&#160;<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62ae8ce5f3eff8feefafa92e9af8b54793d">enum_chi_ab</a> =23, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62ae95ef62d90f98f80ded70f2dd4ae0075">enum_chi_bb</a> =24, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62aefc4480bcfee1b86a12af6ad38b58a3f">enum_ddens_ptx</a> =25, 
<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a398cb4f1130ca4d737fc43839a7e2c63">enum_ddens_pty</a> =26, 
<br />
&#160;&#160;<a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62afd1f2fd45ef99200390df5f6f400771f">enum_ddens_ptz</a> =27
<br />
 }</td></tr>
<tr class="separator:a41609549f1de62ee9474b202700def62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adb76f0686edc6fedec4d9df031067b82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#adb76f0686edc6fedec4d9df031067b82">XCfunctional</a> ()</td></tr>
<tr class="memdesc:adb76f0686edc6fedec4d9df031067b82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor is required.  <a href="#adb76f0686edc6fedec4d9df031067b82">More...</a><br /></td></tr>
<tr class="separator:adb76f0686edc6fedec4d9df031067b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bca41318d49c0d3a1457fe78c479318"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a6bca41318d49c0d3a1457fe78c479318">~XCfunctional</a> ()</td></tr>
<tr class="memdesc:a6bca41318d49c0d3a1457fe78c479318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a6bca41318d49c0d3a1457fe78c479318">More...</a><br /></td></tr>
<tr class="separator:a6bca41318d49c0d3a1457fe78c479318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a369aa39fcc538ccb3084c3fb90eeb683"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a369aa39fcc538ccb3084c3fb90eeb683">exc</a> (const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;t) const</td></tr>
<tr class="memdesc:a369aa39fcc538ccb3084c3fb90eeb683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the energy functional at given points.  <a href="#a369aa39fcc538ccb3084c3fb90eeb683">More...</a><br /></td></tr>
<tr class="separator:a369aa39fcc538ccb3084c3fb90eeb683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c9e78fc38c5a3fbc963724d7e69a22"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a60c9e78fc38c5a3fbc963724d7e69a22">fxc_apply</a> (const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;t, const int ispin) const</td></tr>
<tr class="memdesc:a60c9e78fc38c5a3fbc963724d7e69a22"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute the second derivative of the XC energy wrt the density and apply  <a href="#a60c9e78fc38c5a3fbc963724d7e69a22">More...</a><br /></td></tr>
<tr class="separator:a60c9e78fc38c5a3fbc963724d7e69a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a39131616ed949dcb3e9f456c9e5c5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a30a39131616ed949dcb3e9f456c9e5c5">get_ggatol</a> () const</td></tr>
<tr class="memdesc:a30a39131616ed949dcb3e9f456c9e5c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the binary munging threshold for the final result in the GGA potential/kernel  <a href="#a30a39131616ed949dcb3e9f456c9e5c5">More...</a><br /></td></tr>
<tr class="separator:a30a39131616ed949dcb3e9f456c9e5c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32f91896837f4d5b056312483f48d628"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a32f91896837f4d5b056312483f48d628">get_rhotol</a> () const</td></tr>
<tr class="memdesc:a32f91896837f4d5b056312483f48d628"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the munging threshold for the density  <a href="#a32f91896837f4d5b056312483f48d628">More...</a><br /></td></tr>
<tr class="separator:a32f91896837f4d5b056312483f48d628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e8b16d3d1bb1b3a9b2965ad2f14470"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a05e8b16d3d1bb1b3a9b2965ad2f14470">has_fxc</a> () const</td></tr>
<tr class="memdesc:a05e8b16d3d1bb1b3a9b2965ad2f14470"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the second derivative of the functional is available (not yet supported)  <a href="#a05e8b16d3d1bb1b3a9b2965ad2f14470">More...</a><br /></td></tr>
<tr class="separator:a05e8b16d3d1bb1b3a9b2965ad2f14470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17dd068955267c460e4ead4688e4d0a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ac17dd068955267c460e4ead4688e4d0a">has_kxc</a> () const</td></tr>
<tr class="memdesc:ac17dd068955267c460e4ead4688e4d0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the third derivative of the functional is available (not yet supported)  <a href="#ac17dd068955267c460e4ead4688e4d0a">More...</a><br /></td></tr>
<tr class="separator:ac17dd068955267c460e4ead4688e4d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a843c5a05153e916d9bea9aafe96889ad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a843c5a05153e916d9bea9aafe96889ad">hf_exchange_coefficient</a> () const</td></tr>
<tr class="memdesc:a843c5a05153e916d9bea9aafe96889ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the value of the hf exact exchange coefficient.  <a href="#a843c5a05153e916d9bea9aafe96889ad">More...</a><br /></td></tr>
<tr class="separator:a843c5a05153e916d9bea9aafe96889ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6b79a24318f286dc48635f8e7abf8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#adb6b79a24318f286dc48635f8e7abf8a">initialize</a> (const std::string &amp;input_line, bool polarized, <a class="el" href="classmadness_1_1World.html">World</a> &amp;world, const bool verbose=false)</td></tr>
<tr class="memdesc:adb6b79a24318f286dc48635f8e7abf8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the object from the user input data.  <a href="#adb6b79a24318f286dc48635f8e7abf8a">More...</a><br /></td></tr>
<tr class="separator:adb6b79a24318f286dc48635f8e7abf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07728624885ae7a44539a460cb5d6150"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a07728624885ae7a44539a460cb5d6150">is_dft</a> () const</td></tr>
<tr class="memdesc:a07728624885ae7a44539a460cb5d6150"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if there is a <a class="el" href="classmadness_1_1DFT.html">DFT</a> functional (false probably means Hatree-<a class="el" href="classmadness_1_1Fock.html" title="Computes matrix representation of the Fock operator. ">Fock</a> exchange only)  <a href="#a07728624885ae7a44539a460cb5d6150">More...</a><br /></td></tr>
<tr class="separator:a07728624885ae7a44539a460cb5d6150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba2ecd261913e5b8f795d23a7524cb1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a5ba2ecd261913e5b8f795d23a7524cb1">is_gga</a> () const</td></tr>
<tr class="memdesc:a5ba2ecd261913e5b8f795d23a7524cb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the potential is gga (needs first derivatives)  <a href="#a5ba2ecd261913e5b8f795d23a7524cb1">More...</a><br /></td></tr>
<tr class="separator:a5ba2ecd261913e5b8f795d23a7524cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e8b29824431e5f33993958be7de7f7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a29e8b29824431e5f33993958be7de7f7">is_lda</a> () const</td></tr>
<tr class="memdesc:a29e8b29824431e5f33993958be7de7f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the potential is lda.  <a href="#a29e8b29824431e5f33993958be7de7f7">More...</a><br /></td></tr>
<tr class="separator:a29e8b29824431e5f33993958be7de7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45d262c8a0db074ef87dd8ed0e01925a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a45d262c8a0db074ef87dd8ed0e01925a">is_meta</a> () const</td></tr>
<tr class="memdesc:a45d262c8a0db074ef87dd8ed0e01925a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the potential is meta gga (needs second derivatives ... not yet supported)  <a href="#a45d262c8a0db074ef87dd8ed0e01925a">More...</a><br /></td></tr>
<tr class="separator:a45d262c8a0db074ef87dd8ed0e01925a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db0b4fa927416831683cb379548f9ca"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a3db0b4fa927416831683cb379548f9ca">is_spin_polarized</a> () const</td></tr>
<tr class="memdesc:a3db0b4fa927416831683cb379548f9ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the functional is spin_polarized.  <a href="#a3db0b4fa927416831683cb379548f9ca">More...</a><br /></td></tr>
<tr class="separator:a3db0b4fa927416831683cb379548f9ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3662df5811cd638bee65aee8580977f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a3662df5811cd638bee65aee8580977f6">plot</a> () const</td></tr>
<tr class="memdesc:a3662df5811cd638bee65aee8580977f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crude function to plot the energy and potential functionals.  <a href="#a3662df5811cd638bee65aee8580977f6">More...</a><br /></td></tr>
<tr class="separator:a3662df5811cd638bee65aee8580977f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f51ee14bd497410154a1c52fb4cc50"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a24f51ee14bd497410154a1c52fb4cc50">vxc</a> (const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;t, const int ispin) const</td></tr>
<tr class="memdesc:a24f51ee14bd497410154a1c52fb4cc50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes components of the potential (derivative of the energy functional) at np points.  <a href="#a24f51ee14bd497410154a1c52fb4cc50">More...</a><br /></td></tr>
<tr class="separator:a24f51ee14bd497410154a1c52fb4cc50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4eaa033c6958f704eca535a53fbfdf75"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a4eaa033c6958f704eca535a53fbfdf75">munge_old</a> (double rho)</td></tr>
<tr class="separator:a4eaa033c6958f704eca535a53fbfdf75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a35b5cbe27d2562e98d69decb816a4d82"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a35b5cbe27d2562e98d69decb816a4d82">number_xc_args</a> =28</td></tr>
<tr class="memdesc:a35b5cbe27d2562e98d69decb816a4d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">max number of intermediates  <a href="#a35b5cbe27d2562e98d69decb816a4d82">More...</a><br /></td></tr>
<tr class="separator:a35b5cbe27d2562e98d69decb816a4d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab9019fd993db3ff286f3bfe1f27dd6e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ab9019fd993db3ff286f3bfe1f27dd6e3">make_libxc_args</a> (const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;t, <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;rho, <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;<a class="el" href="svpe_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>, <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;rho_pt, <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;sigma_pt, std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;drho, std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;drho_pt, const bool need_response) const</td></tr>
<tr class="memdesc:ab9019fd993db3ff286f3bfe1f27dd6e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert the raw density (gradient) data to be used by the xc operators  <a href="#ab9019fd993db3ff286f3bfe1f27dd6e3">More...</a><br /></td></tr>
<tr class="separator:ab9019fd993db3ff286f3bfe1f27dd6e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:abb829a268fcba883d5a9704c78d8592e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#abb829a268fcba883d5a9704c78d8592e">polyn</a> (const double x, double &amp;<a class="el" href="derivatives_8cc.html#ad2c6983a6c1401bd9cb4dadf4384c3db">p</a>, double &amp;dpdx)</td></tr>
<tr class="memdesc:abb829a268fcba883d5a9704c78d8592e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smoothly switches between constant (x&lt;xmin) and linear function (x&gt;xmax)  <a href="#abb829a268fcba883d5a9704c78d8592e">More...</a><br /></td></tr>
<tr class="separator:abb829a268fcba883d5a9704c78d8592e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab92ff92b96241a8414c1856cd2a469ad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ab92ff92b96241a8414c1856cd2a469ad">ggatol</a></td></tr>
<tr class="memdesc:ab92ff92b96241a8414c1856cd2a469ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">See initialize and munge*.  <a href="#ab92ff92b96241a8414c1856cd2a469ad">More...</a><br /></td></tr>
<tr class="separator:ab92ff92b96241a8414c1856cd2a469ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a></td></tr>
<tr class="memdesc:aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factor multiplying HF exchange (+1.0 gives HF)  <a href="#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">More...</a><br /></td></tr>
<tr class="separator:aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ee70194ef409e4f3f278ec555f9073"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ae9ee70194ef409e4f3f278ec555f9073">nderiv</a></td></tr>
<tr class="memdesc:ae9ee70194ef409e4f3f278ec555f9073"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of xc kernel derivatives (lda: 0, gga: 1, etc)  <a href="#ae9ee70194ef409e4f3f278ec555f9073">More...</a><br /></td></tr>
<tr class="separator:ae9ee70194ef409e4f3f278ec555f9073"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d60b7037d387bb741e5427fd545cae2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a></td></tr>
<tr class="separator:a0d60b7037d387bb741e5427fd545cae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7ebf629700864d2fc5bbdde3bdbd56"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a></td></tr>
<tr class="memdesc:aeb7ebf629700864d2fc5bbdde3bdbd56"><td class="mdescLeft">&#160;</td><td class="mdescRight">See initialize and munge*.  <a href="#aeb7ebf629700864d2fc5bbdde3bdbd56">More...</a><br /></td></tr>
<tr class="separator:aeb7ebf629700864d2fc5bbdde3bdbd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8aa0c37291c6d5f6dbc14a31719d02c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a></td></tr>
<tr class="memdesc:ac8aa0c37291c6d5f6dbc14a31719d02c"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the functional is spin polarized.  <a href="#ac8aa0c37291c6d5f6dbc14a31719d02c">More...</a><br /></td></tr>
<tr class="separator:ac8aa0c37291c6d5f6dbc14a31719d02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae1040d6d4c1634bd904d706ee17653f0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ae1040d6d4c1634bd904d706ee17653f0">binary_munge</a> (double rho, double refrho, const double <a class="el" href="testinnerext_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>) const</td></tr>
<tr class="memdesc:ae1040d6d4c1634bd904d706ee17653f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">munge rho if refrho is small  <a href="#ae1040d6d4c1634bd904d706ee17653f0">More...</a><br /></td></tr>
<tr class="separator:ae1040d6d4c1634bd904d706ee17653f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea1a8ba26ba532699efcd470fe77ddf2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aea1a8ba26ba532699efcd470fe77ddf2">munge</a> (double rho) const</td></tr>
<tr class="memdesc:aea1a8ba26ba532699efcd470fe77ddf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">simple munging for the density only (LDA)  <a href="#aea1a8ba26ba532699efcd470fe77ddf2">More...</a><br /></td></tr>
<tr class="separator:aea1a8ba26ba532699efcd470fe77ddf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">Simplified interface to XC functionals. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a41609549f1de62ee9474b202700def62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41609549f1de62ee9474b202700def62">&#9670;&nbsp;</a></span>xc_arg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62">madness::XCfunctional::xc_arg</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">The ordering of the intermediates is fixed, but the code can handle non-initialized functions, so if e.g. no GGA is requested, all the corresponding vector components may be left empty.</p>
<p class="">Note the additional quantities <img class="formulaInl" alt="$ \zeta $" src="form_138.png"/> and <img class="formulaInl" alt="$ \chi $" src="form_71.png"/>, which are defined as <img class="formulaInl" alt="$ \rho = exp(\zeta) $" src="form_139.png"/> and thus the derivative of rho is given by <img class="formulaInl" alt="$ \nabla_x\rho = exp(\zeta)\nabla_x\zeta = \rho \nabla_x\zeta $" src="form_140.png"/> The reduced gradients  may then be expressed as <img class="formulaInl" alt="$ \sigma = |\nabla\rho|^2 = |\rho|^2 |\nabla\zeta|^2 = |\rho|^2 \chi $" src="form_141.png"/> </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62af0355a05ca6bf50e8cbd418bde146684"></a>enum_rhoa&#160;</td><td class="fielddoc"><p class="">alpha density <img class="formulaInl" alt="$ \rho_\alpha $" src="form_158.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62aad32f8c17f5996758507ffc75af788e3"></a>enum_rhob&#160;</td><td class="fielddoc"><p class="">beta density <img class="formulaInl" alt="$ \rho_\beta $" src="form_159.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a8b8087b835d89fe8576be80e46af76d3"></a>enum_rho_pt&#160;</td><td class="fielddoc"><p class="">perturbed density (CPHF, TDKS) <img class="formulaInl" alt="$ \rho_{pt} $" src="form_160.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a9d0351d5563ec33c22a09d60b6de8ae6"></a>enum_saa&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \sigma_{aa} = \nabla \rho_{\alpha}.\nabla \rho_{\alpha} $" src="form_161.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62ac7144a1b110a41ec309d68ca8c817a55"></a>enum_sab&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \sigma_{ab} = \nabla \rho_{\alpha}.\nabla \rho_{\beta} $" src="form_162.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a9cf1c0cde82dad883075aafa8128ed80"></a>enum_sbb&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \sigma_{bb} = \nabla \rho_{\beta}.\nabla \rho_{\beta} $" src="form_163.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a5ac32ec5c2e74e7a955aee29dfd991ca"></a>enum_sigtot&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \sigma = \nabla \rho.\nabla \rho $" src="form_164.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62ad5a8723bd6fa4d7b066ee01836125621"></a>enum_sigma_pta_div_rho&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{\alpha}.\nabla\rho_{pt} $" src="form_165.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62aea47e1a7036b0aeacd372e0809b20f77"></a>enum_sigma_ptb_div_rho&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{\beta}.\nabla\rho_{pt} $" src="form_166.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62ac4f018c81b3a3302f74992a506c8a575"></a>enum_zetaa_x&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{a,x}=\partial/{\partial x} \ln(\rho_a) $" src="form_167.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a3ab0ae8366fa0e39cfaa562283b36f17"></a>enum_zetaa_y&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{a,y}=\partial/{\partial y} \ln(\rho_a) $" src="form_168.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62ad0f6e375f222655f1244c975ebfce032"></a>enum_zetaa_z&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{a,z}=\partial/{\partial z} \ln(\rho_a) $" src="form_169.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a5c3d3af1f4d01759807227db0a04ff1a"></a>enum_zetab_x&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{b,x} = \partial/{\partial x} \ln(\rho_b) $" src="form_170.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a17af1c3d07e71f809614d198f3286247"></a>enum_zetab_y&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{b,y} = \partial/{\partial y} \ln(\rho_b) $" src="form_171.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a1f70042480cf92a20e4a5d15c487735f"></a>enum_zetab_z&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \zeta_{b,z} = \partial/{\partial z} \ln(\rho_b) $" src="form_172.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a8f04cefec4fa0851a2244de4975838df"></a>enum_chi_aa&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \chi_{aa} = \nabla \zeta_{\alpha}.\nabla \zeta_{\alpha} $" src="form_173.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62ae8ce5f3eff8feefafa92e9af8b54793d"></a>enum_chi_ab&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \chi_{ab} = \nabla \zeta_{\alpha}.\nabla \zeta_{\beta} $" src="form_174.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62ae95ef62d90f98f80ded70f2dd4ae0075"></a>enum_chi_bb&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \chi_{bb} = \nabla \zeta_{\beta}.\nabla \zeta_{\beta} $" src="form_175.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62aefc4480bcfee1b86a12af6ad38b58a3f"></a>enum_ddens_ptx&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \nabla\rho_{pt}$" src="form_176.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62a398cb4f1130ca4d737fc43839a7e2c63"></a>enum_ddens_pty&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \nabla\rho_{pt}$" src="form_176.png"/> </p>
</td></tr>
<tr><td class="fieldname"><a id="a41609549f1de62ee9474b202700def62afd1f2fd45ef99200390df5f6f400771f"></a>enum_ddens_ptz&#160;</td><td class="fielddoc"><p class=""><img class="formulaInl" alt="$ \nabla\rho_{pt}$" src="form_176.png"/> </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adb76f0686edc6fedec4d9df031067b82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb76f0686edc6fedec4d9df031067b82">&#9670;&nbsp;</a></span>XCfunctional()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">madness::XCfunctional::XCfunctional </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor is required. </p>

<p class="reference">References <a class="el" href="test__sig_8cc.html#aed138f72d7301a9034a719a95c4903da">e()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a>.</p>

</div>
</div>
<a id="a6bca41318d49c0d3a1457fe78c479318"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bca41318d49c0d3a1457fe78c479318">&#9670;&nbsp;</a></span>~XCfunctional()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">madness::XCfunctional::~XCfunctional </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae1040d6d4c1634bd904d706ee17653f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1040d6d4c1634bd904d706ee17653f0">&#9670;&nbsp;</a></span>binary_munge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::binary_munge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>refrho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>thresh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>munge rho if refrho is small </p>
<p class="">special case for perturbed densities, which might be negative and diffuse. Munge rho (e.g. the perturbed density) if the reference density refrho e.g. the ground state density is small. Only where the reference density is large enough <a class="el" href="classmadness_1_1DFT.html">DFT</a> is numerically well-defined. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rho</td><td>number to be munged </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">refrho</td><td>reference value for munging </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>threshold for munging </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, and <a class="el" href="testcosine_8cc.html#a9eab80aaf4be993b3a2cfd79b55f7fb9">thresh</a>.</p>

</div>
</div>
<a id="a369aa39fcc538ccb3084c3fb90eeb683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369aa39fcc538ccb3084c3fb90eeb683">&#9670;&nbsp;</a></span>exc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; madness::XCfunctional::exc </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the energy functional at given points. </p>
<p class="">This uses the convention that the total energy is <img class="formulaInl" alt="$ E[\rho] = \int \epsilon[\rho(x)] dx$" src="form_148.png"/> Any HF exchange contribution must be separately computed. Items in the vector argument <code>t</code> are interpreted similarly to the xc_arg enum. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>The input densities and derivatives as required by the functional </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The exchange-correlation energy functional </dd></dl>

<p class="reference">References <a class="el" href="namespacemadness.html#af54d4defb13f436d68f5dffcfe1899af">madness::c_rks_vwn5__()</a>, <a class="el" href="namespacemadness.html#ab60c0257270dd75fbf805f4b19371dd0">madness::c_uks_vwn5__()</a>, <a class="el" href="namespacemadness.html#a9ce6d524200a2dee9baf7f4e308b8b40">madness::f</a>, <a class="el" href="namespacestd.html#a3251d15ebb1869d7bce44d55a3a594a8">std::isnan()</a>, <a class="el" href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aea1a8ba26ba532699efcd470fe77ddf2">munge()</a>, <a class="el" href="group__libraries.html#ga925cbfa806133b64f5cee7a7d810efeb">madness::print()</a>, <a class="el" href="classmadness_1_1Tensor.html#a132ab2947ff00fba2b37d638ced32308">madness::Tensor&lt; T &gt;::ptr()</a>, <a class="el" href="classmadness_1_1BaseTensor.html#aca8a8b2dfa1aea3e335e80a0edde8f33">madness::BaseTensor::size()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>, <a class="el" href="namespacemadness.html#ab80e491600bc86cbf7113901bbb5b63a">madness::x_rks_s__()</a>, <a class="el" href="namespacemadness.html#a9929afdb3af0f6d0f8fcef20eed027f0">madness::x_uks_s__()</a>, and <a class="el" href="smooth_8h.html#a135c4a45a23fef38931d37fff6aa15e1">xf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="structmadness_1_1xc__functional.html#a7cb3ec1f8d926cb7547b170493f822a0">madness::xc_functional::operator()()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3662df5811cd638bee65aee8580977f6">plot()</a>, and <a class="el" href="testlda_8cc.html#a66db437ff0cc42e0e4ad60e17627a455">test_lda()</a>.</p>

</div>
</div>
<a id="a60c9e78fc38c5a3fbc963724d7e69a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c9e78fc38c5a3fbc963724d7e69a22">&#9670;&nbsp;</a></span>fxc_apply()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; madness::XCfunctional::fxc_apply </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ispin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute the second derivative of the XC energy wrt the density and apply </p>
<p class="">Return the following quantities (RHF only) (see Yanai2005, Eq. (13)) </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \mbox{result[0]} &amp;:&amp; \qquad \frac{\partial^2 \epsilon}{\partial \rho^2} \rho_\mathrm{pt} + 2.0 * \frac{\partial^2 \epsilon}{\partial \rho\partial\sigma}\sigma_\mathrm{pt}\\ \mbox{result[1-3]} &amp;:&amp; \qquad 2.0 * \frac{\partial\epsilon}{\partial\sigma}\nabla\rho_\mathrm{pt} + 2.0 * \frac{\partial^2\epsilon}{\partial\rho\partial\sigma} \rho_\mathrm{pt}\nabla\rho + 4.0 * \frac{\partial^2\epsilon}{\partial^2\sigma} \sigma_\mathrm{pt}\nabla\rho \end{eqnarray*}" src="form_157.png"/>
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>The input densities and derivatives as required by the functional, as in the xc_arg enum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ispin</td><td>not referenced since only RHF is implemented, always 0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a vector of Functions containing the contributions to the kernel apply </dd></dl>

<p class="reference">References <a class="el" href="madness__exception_8h.html#a629efc935073cf10318bc5bf759ad8f3">MADNESS_EXCEPTION</a>.</p>

<p class="reference">Referenced by <a class="el" href="structmadness_1_1xc__kernel__apply.html#a70b5de058aeba1f42986e3853734b3dc">madness::xc_kernel_apply::operator()()</a>.</p>

</div>
</div>
<a id="a30a39131616ed949dcb3e9f456c9e5c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a39131616ed949dcb3e9f456c9e5c5">&#9670;&nbsp;</a></span>get_ggatol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::get_ggatol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the binary munging threshold for the final result in the GGA potential/kernel </p>
<p class="">the GGA potential will be munged based on the smallness of the original density, which we call binary munging </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#ab92ff92b96241a8414c1856cd2a469ad">ggatol</a>.</p>

</div>
</div>
<a id="a32f91896837f4d5b056312483f48d628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32f91896837f4d5b056312483f48d628">&#9670;&nbsp;</a></span>get_rhotol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::get_rhotol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return the munging threshold for the density </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a>.</p>

</div>
</div>
<a id="a05e8b16d3d1bb1b3a9b2965ad2f14470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e8b16d3d1bb1b3a9b2965ad2f14470">&#9670;&nbsp;</a></span>has_fxc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::has_fxc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the second derivative of the functional is available (not yet supported) </p>

</div>
</div>
<a id="ac17dd068955267c460e4ead4688e4d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac17dd068955267c460e4ead4688e4d0a">&#9670;&nbsp;</a></span>has_kxc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::has_kxc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the third derivative of the functional is available (not yet supported) </p>

</div>
</div>
<a id="a843c5a05153e916d9bea9aafe96889ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a843c5a05153e916d9bea9aafe96889ad">&#9670;&nbsp;</a></span>hf_exchange_coefficient()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::hf_exchange_coefficient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the value of the hf exact exchange coefficient. </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a>.</p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1SCF.html#a3081cf25d6dbd95ae73e249a2492bf65">madness::SCF::apply_potential()</a>, <a class="el" href="classmadness_1_1SCF.html#a2ff5ad8c9bb4ebbb7d0fbf09e4982937">madness::SCF::apply_potential_response()</a>, <a class="el" href="classmadness_1_1SCF.html#a15ccbce71e3ff110c1c797b2c1db1166">madness::SCF::calc_djkmo()</a>, and <a class="el" href="classmadness_1_1SCF.html#a1d6244bb4a96cfe0d8ff7faed65fad48">madness::SCF::calc_xc_function()</a>.</p>

</div>
</div>
<a id="adb6b79a24318f286dc48635f8e7abf8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6b79a24318f286dc48635f8e7abf8a">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void madness::XCfunctional::initialize </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>input_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>polarized</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmadness_1_1World.html">World</a> &amp;&#160;</td>
          <td class="paramname"><em>world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the object from the user input data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_line</td><td>User input line (without beginning XC keyword) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">polarized</td><td>Boolean flag indicating if the calculation is spin-polarized </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="test__sig_8cc.html#aed138f72d7301a9034a719a95c4903da">e()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>, and <a class="el" href="namespacemadness.html#aec23075bfdac45b4af20be4ce099a277">madness::transform()</a>.</p>

<p class="reference">Referenced by <a class="el" href="newsolver__lda_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a>, <a class="el" href="classMiniDFT.html#a2bf92eb00325e08421d8aee5f1655ec7">MiniDFT::MiniDFT()</a>, <a class="el" href="classmadness_1_1SCF.html#a33042f83832c9ea875d58580fa727ada">madness::SCF::SCF()</a>, <a class="el" href="testlda_8cc.html#a66db437ff0cc42e0e4ad60e17627a455">test_lda()</a>, and <a class="el" href="plotxc_8cc.html#a7d438db0c80e4cec014bee866ab7be91">test_xcfunctional()</a>.</p>

</div>
</div>
<a id="a07728624885ae7a44539a460cb5d6150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07728624885ae7a44539a460cb5d6150">&#9670;&nbsp;</a></span>is_dft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::is_dft </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if there is a <a class="el" href="classmadness_1_1DFT.html">DFT</a> functional (false probably means Hatree-<a class="el" href="classmadness_1_1Fock.html" title="Computes matrix representation of the Fock operator. ">Fock</a> exchange only) </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#a5ba2ecd261913e5b8f795d23a7524cb1">is_gga()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a29e8b29824431e5f33993958be7de7f7">is_lda()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a45d262c8a0db074ef87dd8ed0e01925a">is_meta()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1SCF.html#a3081cf25d6dbd95ae73e249a2492bf65">madness::SCF::apply_potential()</a>, <a class="el" href="classmadness_1_1SCF.html#a2ff5ad8c9bb4ebbb7d0fbf09e4982937">madness::SCF::apply_potential_response()</a>, and <a class="el" href="classmadness_1_1SCF.html#a1d6244bb4a96cfe0d8ff7faed65fad48">madness::SCF::calc_xc_function()</a>.</p>

</div>
</div>
<a id="a5ba2ecd261913e5b8f795d23a7524cb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba2ecd261913e5b8f795d23a7524cb1">&#9670;&nbsp;</a></span>is_gga()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::is_gga </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the potential is gga (needs first derivatives) </p>

<p class="reference">Referenced by <a class="el" href="classWSTFunctional.html#a0306ec063a67e719d1f30c525a0034f8">WSTFunctional::apply_xc()</a>, <a class="el" href="structmadness_1_1xc__potential.html#a0ec4c173789d47293886d454fdee37e5">madness::xc_potential::get_result_size()</a>, <a class="el" href="structmadness_1_1xc__kernel__apply.html#ab134ca7f2424bd0451bf70103c61b3c9">madness::xc_kernel_apply::get_result_size()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a07728624885ae7a44539a460cb5d6150">is_dft()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3662df5811cd638bee65aee8580977f6">plot()</a>, and <a class="el" href="plotxc_8cc.html#a7d438db0c80e4cec014bee866ab7be91">test_xcfunctional()</a>.</p>

</div>
</div>
<a id="a29e8b29824431e5f33993958be7de7f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29e8b29824431e5f33993958be7de7f7">&#9670;&nbsp;</a></span>is_lda()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::is_lda </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the potential is lda. </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a>.</p>

<p class="reference">Referenced by <a class="el" href="structmadness_1_1xc__potential.html#a0ec4c173789d47293886d454fdee37e5">madness::xc_potential::get_result_size()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a07728624885ae7a44539a460cb5d6150">is_dft()</a>.</p>

</div>
</div>
<a id="a45d262c8a0db074ef87dd8ed0e01925a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45d262c8a0db074ef87dd8ed0e01925a">&#9670;&nbsp;</a></span>is_meta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::is_meta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the potential is meta gga (needs second derivatives ... not yet supported) </p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a07728624885ae7a44539a460cb5d6150">is_dft()</a>.</p>

</div>
</div>
<a id="a3db0b4fa927416831683cb379548f9ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3db0b4fa927416831683cb379548f9ca">&#9670;&nbsp;</a></span>is_spin_polarized()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::is_spin_polarized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the functional is spin_polarized. </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>.</p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1SCF.html#a3081cf25d6dbd95ae73e249a2492bf65">madness::SCF::apply_potential()</a>, <a class="el" href="structmadness_1_1xc__potential.html#a0ec4c173789d47293886d454fdee37e5">madness::xc_potential::get_result_size()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3662df5811cd638bee65aee8580977f6">plot()</a>, and <a class="el" href="plotxc_8cc.html#a7d438db0c80e4cec014bee866ab7be91">test_xcfunctional()</a>.</p>

</div>
</div>
<a id="ab9019fd993db3ff286f3bfe1f27dd6e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9019fd993db3ff286f3bfe1f27dd6e3">&#9670;&nbsp;</a></span>make_libxc_args()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::XCfunctional::make_libxc_args </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rho_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>drho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>drho_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>need_response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>convert the raw density (gradient) data to be used by the xc operators </p>
<p class="">Involves mainly munging of the densities and multiplying with 2 if the calculation is spin-restricted. Response densities and density gradients are munged based on the value of the ground state density, since they may become negative and may also be much more diffuse. dimensions of the output tensors are for spin-restricted and unrestricted (with np the number of grid points in the box): rho(np) or rho(2*np) sigma(np) sigma(3*np) rho_pt(np) sigma_pt(2*np) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>input density (gradients) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rho</td><td>ground state (spin) density, properly munged </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sigma</td><td>ground state (spin) density gradients, properly munged </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rho_pt</td><td>response density, properly munged (no spin) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sigma_pt</td><td>response (spin) density gradients, properly munged </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">drho</td><td>density derivative, constructed from rho and zeta </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">drho_pt</td><td>response density derivative directly from xc_args </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">need_response</td><td>flag if rho_pt and sigma_pt need to be calculated </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">References <a class="el" href="madness__exception_8h.html#a629efc935073cf10318bc5bf759ad8f3">MADNESS_EXCEPTION</a>.</p>

</div>
</div>
<a id="aea1a8ba26ba532699efcd470fe77ddf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea1a8ba26ba532699efcd470fe77ddf2">&#9670;&nbsp;</a></span>munge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::munge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>simple munging for the density only (LDA) </p>

<p class="reference">References <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a>.</p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a369aa39fcc538ccb3084c3fb90eeb683">exc()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a24f51ee14bd497410154a1c52fb4cc50">vxc()</a>.</p>

</div>
</div>
<a id="a4eaa033c6958f704eca535a53fbfdf75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eaa033c6958f704eca535a53fbfdf75">&#9670;&nbsp;</a></span>munge_old()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double madness::XCfunctional::munge_old </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="derivatives_8cc.html#ad2c6983a6c1401bd9cb4dadf4384c3db">p()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#abb829a268fcba883d5a9704c78d8592e">polyn()</a>.</p>

</div>
</div>
<a id="a3662df5811cd638bee65aee8580977f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3662df5811cd638bee65aee8580977f6">&#9670;&nbsp;</a></span>plot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::XCfunctional::plot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Crude function to plot the energy and potential functionals. </p>

<p class="reference">References <a class="el" href="test__sig_8cc.html#aed138f72d7301a9034a719a95c4903da">e()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62af0355a05ca6bf50e8cbd418bde146684">enum_rhoa</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62aad32f8c17f5996758507ffc75af788e3">enum_rhob</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a41609549f1de62ee9474b202700def62a9d0351d5563ec33c22a09d60b6de8ae6">enum_saa</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a369aa39fcc538ccb3084c3fb90eeb683">exc()</a>, <a class="el" href="namespacemadness.html#a9ce6d524200a2dee9baf7f4e308b8b40">madness::f</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a5ba2ecd261913e5b8f795d23a7524cb1">is_gga()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3db0b4fa927416831683cb379548f9ca">is_spin_polarized()</a>, <a class="el" href="apps_2chem_2mp2_8cc.html#ad39844fb882f3912c47cee0c368b3dd3">lo</a>, <a class="el" href="lda_8h.html#a38bdefe23f7d45690f9f1f8f1d6ba755">pow()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a24f51ee14bd497410154a1c52fb4cc50">vxc()</a>.</p>

</div>
</div>
<a id="abb829a268fcba883d5a9704c78d8592e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb829a268fcba883d5a9704c78d8592e">&#9670;&nbsp;</a></span>polyn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void madness::XCfunctional::polyn </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dpdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Smoothly switches between constant (x&lt;xmin) and linear function (x&gt;xmax) </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(x,x_{\mathrm{min}},x_{\mathrm{max}}) = \left\{ \begin{array}{ll} x_{\mathrm{min}} &amp; x &lt; x_{\mathrm{min}} \\ p(x,x_{\mathrm{min}},x_{\mathrm{max}}) &amp; x_{\mathrm{min}} \leq x_{\mathrm{max}} \\ x &amp; x_{\mathrm{max}} &lt; x \end{array} \right. \]" src="form_142.png"/>
</p>
<p> where <img class="formulaInl" alt="$p(x)$" src="form_143.png"/> is the unique quintic polynomial that satisfies <img class="formulaInl" alt="$p(x_{min})=x_{min}$" src="form_144.png"/>, <img class="formulaInl" alt="$p(x_{max})=x_{max}$" src="form_145.png"/>, <img class="formulaInl" alt="$dp(x_{max})/dx=1$" src="form_146.png"/>, and <img class="formulaInl" alt="$dp(x_{min})/dx=d^2p(x_{min})/dx^2=d^2p(x_{max})/dx^2=0$" src="form_147.png"/>. </p>

<p class="reference">References <a class="el" href="nonlinschro_8cc.html#ab725778fe3179d0229a8da4c908bdf61">a</a>, <a class="el" href="nonlinschro_8cc.html#a8f5a312161775190357a664a77a831a3">b</a>, <a class="el" href="heat_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, <a class="el" href="test__sig_8cc.html#a06ff3b9521de2f6a4e82b256e48e902a">d()</a>, <a class="el" href="test__sig_8cc.html#aed138f72d7301a9034a719a95c4903da">e()</a>, and <a class="el" href="derivatives_8cc.html#ad2c6983a6c1401bd9cb4dadf4384c3db">p()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a4eaa033c6958f704eca535a53fbfdf75">munge_old()</a>.</p>

</div>
</div>
<a id="a24f51ee14bd497410154a1c52fb4cc50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f51ee14bd497410154a1c52fb4cc50">&#9670;&nbsp;</a></span>vxc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; madness::XCfunctional::vxc </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmadness_1_1Tensor.html">madness::Tensor</a>&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ispin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes components of the potential (derivative of the energy functional) at np points. </p>
<p class="">Any HF exchange contribution must be separately computed. Items in the vector argument <code>t</code> are interpreted similarly to the xc_arg enum.</p>
<p class="">We define <img class="formulaInl" alt="$ \sigma_{\mu \nu} = \nabla \rho_{\mu} . \nabla \rho_{\nu} $" src="form_149.png"/> with <img class="formulaInl" alt="$ \mu, \nu = \alpha$" src="form_150.png"/> or <img class="formulaInl" alt="$ \beta $" src="form_151.png"/>.</p>
<p class="">For unpolarized GGA, matrix elements of the potential are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ &lt; \phi | \hat V | \psi &gt; = \int \left( \frac{\partial \epsilon}{\partial \rho} \phi \psi + \left( 2 \frac{\partial \epsilon}{\partial \sigma} \right) \nabla \rho \cdot \nabla \left( \phi \psi \right) \right) dx \]" src="form_152.png"/>
</p>
<p class="">For polarized GGA, matrix elements of the potential are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ &lt; \phi_{\alpha} | \hat V | \psi_{\alpha} &gt; = \int \left( \frac{\partial \epsilon}{\partial \rho_{\alpha}} \phi \psi + \left( 2 \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} \nabla \rho_{\alpha} + \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} \nabla \rho_{\beta} \right) . \nabla \left( \phi \psi \right) \right) dx \]" src="form_153.png"/>
</p>
<p class="">Integrating the above by parts and assuming free-space or periodic boundary conditions we obtain that the local multiplicative form of the GGA potential is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ V_{\alpha} = \frac{\partial \epsilon}{\partial \rho_{\alpha}} - \left(\nabla . \left(2 \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} \nabla \rho_{\alpha} + \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} \nabla \rho_{\beta} \right) \right) \]" src="form_154.png"/>
</p>
<p class="">Return the following quantities for RHF: (see Yanai2005, Eq. (12)) </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \mbox{result[0]} &amp;:&amp; \qquad \frac{\partial \epsilon}{\partial \rho} \\ \mbox{result[1-3]} &amp;:&amp; \qquad 2 \rho \frac{\partial \epsilon}{\partial \sigma} \nabla\rho \end{eqnarray*}" src="form_155.png"/>
</p>
<p> and for UHF same-spin and other-spin quantities </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \mbox{result[0]} &amp;:&amp; \qquad \frac{\partial \epsilon}{\partial \rho_{\alpha}} \\ \mbox{result[1-3]} &amp;:&amp; \qquad \rho_\alpha \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} \nabla\rho_\alpha\\ \mbox{result[4-6]} &amp;:&amp; \qquad \rho_\alpha \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} \nabla\rho_\beta \end{eqnarray*}" src="form_156.png"/>
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>The input densities and derivatives as required by the functional </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ispin</td><td>Specifies which component of the potential is to be computed as described above </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the requested quantity, based on ispin (0: same spin, 1: other spin) </dd></dl>

<p class="reference">References <a class="el" href="namespacemadness.html#af54d4defb13f436d68f5dffcfe1899af">madness::c_rks_vwn5__()</a>, <a class="el" href="namespacemadness.html#ab60c0257270dd75fbf805f4b19371dd0">madness::c_uks_vwn5__()</a>, <a class="el" href="namespacemadness.html#a9ce6d524200a2dee9baf7f4e308b8b40">madness::f</a>, <a class="el" href="namespacestd.html#a3251d15ebb1869d7bce44d55a3a594a8">std::isnan()</a>, <a class="el" href="ewald_8cc.html#a2442c8274ae11905a74c1bf95501af09">L</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aea1a8ba26ba532699efcd470fe77ddf2">munge()</a>, <a class="el" href="group__libraries.html#ga925cbfa806133b64f5cee7a7d810efeb">madness::print()</a>, <a class="el" href="testbsh_8cc.html#acd4d73aaad9c6661993e51761fc15a3f">q()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>, <a class="el" href="namespacemadness.html#ab80e491600bc86cbf7113901bbb5b63a">madness::x_rks_s__()</a>, <a class="el" href="namespacemadness.html#a9929afdb3af0f6d0f8fcef20eed027f0">madness::x_uks_s__()</a>, and <a class="el" href="smooth_8h.html#a135c4a45a23fef38931d37fff6aa15e1">xf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="structmadness_1_1xc__potential.html#a828e5ca1a5926b05c4411397bba7891c">madness::xc_potential::operator()()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3662df5811cd638bee65aee8580977f6">plot()</a>, <a class="el" href="testlda_8cc.html#a66db437ff0cc42e0e4ad60e17627a455">test_lda()</a>, and <a class="el" href="plotxc_8cc.html#a7d438db0c80e4cec014bee866ab7be91">test_xcfunctional()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab92ff92b96241a8414c1856cd2a469ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab92ff92b96241a8414c1856cd2a469ad">&#9670;&nbsp;</a></span>ggatol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::ggatol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>See initialize and munge*. </p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a30a39131616ed949dcb3e9f456c9e5c5">get_ggatol()</a>.</p>

</div>
</div>
<a id="aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">&#9670;&nbsp;</a></span>hf_coeff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::hf_coeff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Factor multiplying HF exchange (+1.0 gives HF) </p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a843c5a05153e916d9bea9aafe96889ad">hf_exchange_coefficient()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#adb6b79a24318f286dc48635f8e7abf8a">initialize()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a29e8b29824431e5f33993958be7de7f7">is_lda()</a>.</p>

</div>
</div>
<a id="ae9ee70194ef409e4f3f278ec555f9073"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ee70194ef409e4f3f278ec555f9073">&#9670;&nbsp;</a></span>nderiv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int madness::XCfunctional::nderiv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the number of xc kernel derivatives (lda: 0, gga: 1, etc) </p>

</div>
</div>
<a id="a35b5cbe27d2562e98d69decb816a4d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35b5cbe27d2562e98d69decb816a4d82">&#9670;&nbsp;</a></span>number_xc_args</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int madness::XCfunctional::number_xc_args =28</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>max number of intermediates </p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCOperator.html#adc288867456e0b8c394045184206c68b">madness::XCOperator::prep_xc_args()</a>.</p>

</div>
</div>
<a id="a0d60b7037d387bb741e5427fd545cae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d60b7037d387bb741e5427fd545cae2">&#9670;&nbsp;</a></span>rhomin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::rhomin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae1040d6d4c1634bd904d706ee17653f0">binary_munge()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#adb6b79a24318f286dc48635f8e7abf8a">initialize()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aea1a8ba26ba532699efcd470fe77ddf2">munge()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#adb76f0686edc6fedec4d9df031067b82">XCfunctional()</a>.</p>

</div>
</div>
<a id="aeb7ebf629700864d2fc5bbdde3bdbd56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb7ebf629700864d2fc5bbdde3bdbd56">&#9670;&nbsp;</a></span>rhotol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::rhotol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>See initialize and munge*. </p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a32f91896837f4d5b056312483f48d628">get_rhotol()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#adb6b79a24318f286dc48635f8e7abf8a">initialize()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aea1a8ba26ba532699efcd470fe77ddf2">munge()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#adb76f0686edc6fedec4d9df031067b82">XCfunctional()</a>.</p>

</div>
</div>
<a id="ac8aa0c37291c6d5f6dbc14a31719d02c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8aa0c37291c6d5f6dbc14a31719d02c">&#9670;&nbsp;</a></span>spin_polarized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::spin_polarized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the functional is spin polarized. </p>

<p class="reference">Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a369aa39fcc538ccb3084c3fb90eeb683">exc()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#adb6b79a24318f286dc48635f8e7abf8a">initialize()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3db0b4fa927416831683cb379548f9ca">is_spin_polarized()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a24f51ee14bd497410154a1c52fb4cc50">vxc()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="xcfunctional_8h_source.html">xcfunctional.h</a></li>
<li><a class="el" href="xcfunctional__ldaonly_8cc.html">xcfunctional_ldaonly.cc</a></li>
<li><a class="el" href="xcfunctional__libxc_8cc.html">xcfunctional_libxc.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 6 2020 16:37:54 for MADNESS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
